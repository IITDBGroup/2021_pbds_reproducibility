select bit_or_blob(prov_s1) as prov_s1, bit_or_blob(prov_l1) as prov_l1 from (
select
	s_name,
	count(*) as numwait,
  bit_or_ints(prov_s1) as prov_s1,
  bit_or_blob(prov_l1) as prov_l1
from
		(select  s_nationkey, s_name, s_suppkey, binsearch_ranges_pos(s_suppkey, (SELECT bounds_to_blob(b) FROM (VALUES (1),(250),(500),(750),(1000),(1250),(1500),(1750),(2000),(2250),(2500),(2750),(3000),(3250),(3500),(3750),(4000),(4250),(4500),(4750),(5000),(5250),(5500),(5750),(6000),(6250),(6500),(6750),(7000),(7250),(7500),(7750),(8000),(8250),(8500),(8750),(9000),(9250),(9500),(9750),(10000),(10250),(10500),(10750),(11000),(11250),(11500),(11750),(12000),(12250),(12500),(12750),(13000),(13250),(13500),(13750),(14000),(14250),(14500),(14750),(15000),(15250),(15500),(15750),(16000),(16250),(16500),(16750),(17000),(17250),(17500),(17750),(18000),(18250),(18500),(18750),(19000),(19250),(19500),(19750),(20000),(20250),(20500),(20750),(21000),(21250),(21500),(21750),(22000),(22250),(22500),(22750),(23000),(23250),(23500),(23750),(24000),(24250),(24500),(24750),(25000),(25250),(25500),(25750),(26000),(26250),(26500),(26750),(27000),(27250),(27500),(27750),(28000),(28250),(28500),(28750),(29000),(29250),(29500),(29750),(30000),(30250),(30500),(30750),(31000),(31250),(31500),(31750),(32000),(32250),(32500),(32750),(33000),(33250),(33500),(33750),(34000),(34250),(34500),(34750),(35000),(35250),(35500),(35750),(36000),(36250),(36500),(36750),(37000),(37250),(37500),(37750),(38000),(38250),(38500),(38750),(39000),(39250),(39500),(39750),(40000),(40250),(40500),(40750),(41000),(41250),(41500),(41750),(42000),(42250),(42500),(42750),(43000),(43250),(43500),(43750),(44000),(44250),(44500),(44750),(45000),(45250),(45500),(45750),(46000),(46250),(46500),(46750),(47000),(47250),(47500),(47750),(48000),(48250),(48500),(48750),(49000),(49250),(49500),(49750),(50000),(50250),(50500),(50750),(51000),(51250),(51500),(51750),(52000),(52250),(52500),(52750),(53000),(53250),(53500),(53750),(54000),(54250),(54500),(54750),(55000),(55250),(55500),(55750),(56000),(56250),(56500),(56750),(57000),(57250),(57500),(57750),(58000),(58250),(58500),(58750),(59000),(59250),(59500),(59750),(60000),(60250),(60500),(60750),(61000),(61250),(61500),(61750),(62000),(62250),(62500),(62750),(63000),(63250),(63500),(63750),(64000),(64250),(64500),(64750),(65000),(65250),(65500),(65750),(66000),(66250),(66500),(66750),(67000),(67250),(67500),(67750),(68000),(68250),(68500),(68750),(69000),(69250),(69500),(69750),(70000),(70250),(70500),(70750),(71000),(71250),(71500),(71750),(72000),(72250),(72500),(72750),(73000),(73250),(73500),(73750),(74000),(74250),(74500),(74750),(75000),(75250),(75500),(75750),(76000),(76250),(76500),(76750),(77000),(77250),(77500),(77750),(78000),(78250),(78500),(78750),(79000),(79250),(79500),(79750),(80000),(80250),(80500),(80750),(81000),(81250),(81500),(81750),(82000),(82250),(82500),(82750),(83000),(83250),(83500),(83750),(84000),(84250),(84500),(84750),(85000),(85250),(85500),(85750),(86000),(86250),(86500),(86750),(87000),(87250),(87500),(87750),(88000),(88250),(88500),(88750),(89000),(89250),(89500),(89750),(90000),(90250),(90500),(90750),(91000),(91250),(91500),(91750),(92000),(92250),(92500),(92750),(93000),(93250),(93500),(93750),(94000),(94250),(94500),(94750),(95000),(95250),(95500),(95750),(96000),(96250),(96500),(96750),(97000),(97250),(97500),(97750),(98000),(98250),(98500),(98750),(99000),(99250),(99500),(99750),(100001)) AS g(b))) AS prov_s1 from supplier) s1,
	(select l_orderkey, l_suppkey, l_receiptdate, l_commitdate, prov_l1 from (
select l_orderkey, l_suppkey,l_receiptdate, l_commitdate, sum(dateb) as datebc, bit_or_ints(prov_l1) as prov_l1 from (
select  l1.l_orderkey, l1.l_suppkey, l1.l_receiptdate, l1.l_commitdate, case when l2.l_receiptdate > l2.l_commitdate then  1 else  0 end as dateb, prov_l1 from ( select l_quantity,l_returnflag,l_orderkey, l_shipdate, l_extendedprice, l_commitdate,l_receiptdate,l_suppkey,l_discount, binsearch_ranges_pos(l_orderkey, (SELECT bounds_to_blob(b) FROM (VALUES (1),(145509),(300710),(469600),(624737),(782116),(979072),(1145892),(1315492),(1475649),(1644771),(1832001),(1994565),(2145991),(2306183),(2480292),(2625699),(2771909),(2941632),(3139237),(3284706),(3446919),(3607812),(3763168),(3929250),(4101798),(4279041),(4440930),(4611234),(4762242),(4914213),(5057252),(5204454),(5357667),(5514368),(5643140),(5789763),(5933696),(6076935),(6225350),(6363009),(6511074),(6640709),(6791366),(6924422),(7068768),(7209633),(7365634),(7515299),(7662149),(7808099),(7955046),(8113216),(8268004),(8406340),(8552706),(8699617),(8847265),(8977472),(9120481),(9256135),(9414628),(9561344),(9700901),(9852867),(9997506),(10133760),(10256609),(10411430),(10552934),(10700676),(10849382),(10998979),(11134435),(11291203),(11454945),(11588802),(11719745),(11861479),(12020836),(12174694),(12321607),(12476801),(12616804),(12788583),(12946724),(13098406),(13252487),(13400803),(13553829),(13706944),(13857319),(14007138),(14152640),(14292227),(14436548),(14589475),(14763398),(14908737),(15057221),(15195907),(15347938),(15504896),(15643940),(15758659),(15895714),(16038756),(16192641),(16352711),(16505569),(16643363),(16777249),(16904615),(17056162),(17207008),(17362661),(17500097),(17641926),(17787013),(17924644),(18073763),(18213091),(18341413),(18467235),(18623300),(18757863),(18918528),(19066055),(19227718),(19371239),(19541092),(19696834),(19843586),(19988544),(20143911),(20296390),(20460640),(20610402),(20755205),(20883268),(21018241),(21161188),(21324739),(21479137),(21631584),(21789222),(21936067),(22088039),(22223366),(22385153),(22529732),(22688000),(22838722),(22979137),(23138433),(23312966),(23444097),(23598535),(23757029),(23919909),(24055968),(24191335),(24348422),(24503140),(24644836),(24788131),(24962342),(25118530),(25264422),(25424166),(25572903),(25717921),(25857826),(26013639),(26183074),(26318242),(26488261),(26634918),(26787268),(26923015),(27085127),(27234880),(27373539),(27528545),(27647461),(27789767),(27945383),(28113317),(28283681),(28453187),(28593830),(28747650),(28900003),(29064579),(29216295),(29375714),(29510946),(29637923),(29776036),(29914212),(30068228),(30242882),(30379429),(30534240),(30700963),(30841314),(30984929),(31151175),(31297921),(31439042),(31599042),(31738464),(31889281),(32028231),(32176614),(32322084),(32460998),(32622948),(32761541),(32910726),(33064323),(33208230),(33362500),(33492166),(33623527),(33806055),(33964327),(34102051),(34240486),(34390566),(34550822),(34725093),(34896704),(35043008),(35174816),(35328451),(35482595),(35635297),(35804487),(35911717),(36058279),(36207746),(36330694),(36449060),(36589318),(36728198),(36893760),(37035168),(37183237),(37335079),(37482593),(37620196),(37768836),(37931814),(38076066),(38226913),(38400802),(38544035),(38686823),(38847172),(39012099),(39161412),(39334465),(39502915),(39634660),(39790337),(39919685),(40063940),(40229030),(40397158),(40549157),(40682471),(40828352),(40972227),(41116773),(41274368),(41437607),(41565890),(41696930),(41856615),(42023555),(42185314),(42338566),(42475271),(42622661),(42783715),(42954305),(43107303),(43253089),(43398019),(43549349),(43726309),(43874243),(44036099),(44180807),(44331653),(44488069),(44625058),(44765346),(44916096),(45060801),(45218279),(45368581),(45531586),(45687491),(45851110),(46022240),(46146272),(46291108),(46444994),(46582785),(46727297),(46874786),(47016774),(47157062),(47314560),(47452832),(47607938),(47771397),(47926305),(48092007),(48223973),(48382080),(48540807),(48695298),(48836902),(48957733),(49097824),(49247585),(49389187),(49555014),(49722500),(49864133),(49983813),(50128804),(50275553),(50433537),(50585379),(50742818),(50903328),(51055079),(51190053),(51330592),(51461762),(51593922),(51746371),(51898017),(52061061),(52210563),(52363207),(52517765),(52664547),(52832320),(52992768),(53135170),(53275621),(53417187),(53543556),(53678691),(53842054),(53975781),(54108866),(54243618),(54409122),(54549862),(54700929),(54844769),(54983393),(55121634),(55307586),(55486979),(55654821),(55819911),(55965922),(56108039),(56235105),(56396866),(56559782),(56703234),(56838592),(56989479),(57159687),(57302117),(57462532),(57601479),(57757062),(57900448),(58052289),(58206054),(58354438),(58519812),(58670278),(58809250),(58966720),(59107778),(59253317),(59396576),(59534977),(59689382),(59840321),(60000001)) AS g(b))) AS prov_l1 from lineitem ) l1, lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey) l group by l_orderkey, l_suppkey, l_receiptdate, l_commitdate) ll where datebc = 0) l1,
	orders,
	nation
where
	s_suppkey = l1.l_suppkey
	and o_orderkey = l1.l_orderkey
	and o_orderstatus = 'F'
	and l1.l_receiptdate > l1.l_commitdate
	and s_nationkey = n_nationkey
	and n_name = 'CHINA'
group by
	s_name
order by
	numwait desc,
	s_name
LIMIT 100) f;
