select bit_or_ints(prov_s) as prov_s,
bit_or_ints(prov_p) as prov_p,
 bit_or_ints(prov_ps1) as prov_ps1,
  bit_or_blob(prov_ps2) as prov_ps2  from (
select s_acctbal,s_name,n_name,p_partkey,p_mfgr,s_address,s_phone,s_comment, prov_s, prov_p, prov_ps1, prov_ps2
from (select p_partkey, p_type,p_size,p_mfgr, binsearch_ranges_pos(p_partkey, blob '01000000000000006A18000000000000D4300000000000003E49000000000000A861000000000000127A0000000000007C92000000000000E6AA00000000000050C3000000000000BADB00000000000024F40000000000008E0C010000000000F824010000000000623D010000000000CC55010000000000366E010000000000A0860100000000000A9F01000000000074B7010000000000DECF01000000000048E8010000000000B2000200000000001C190200000000008631020000000000F0490200000000005A62020000000000C47A0200000000002E9302000000000098AB02000000000002C40200000000006CDC020000000000D6F4020000000000410D030000000000') AS prov_p from part) p1,
(select s_acctbal, s_name,s_suppkey, s_nationkey,s_address,s_phone,s_comment, binsearch_ranges_pos(s_suppkey, blob '010000000000000039010000000000007102000000000000AA03000000000000E2040000000000001B0600000000000053070000000000008C08000000000000C409000000000000FD0A000000000000350C0000000000006E0D000000000000A60E000000000000DF0F000000000000171100000000000050120000000000008813000000000000C114000000000000F91500000000000032170000000000006A18000000000000A319000000000000DB1A000000000000141C0000000000004C1D000000000000851E000000000000BD1F000000000000F6200000000000002E2200000000000067230000000000009F24000000000000D8250000000000001127000000000000') AS prov_s from supplier) s1,
(select ps_partkey, ps_suppkey, ps_supplycost, binsearch_ranges_pos(ps_partkey, blob '01000000000000006A18000000000000D4300000000000003E49000000000000A861000000000000127A0000000000007C92000000000000E6AA00000000000050C3000000000000BADB00000000000024F40000000000008E0C010000000000F824010000000000623D010000000000CC55010000000000366E010000000000A0860100000000000A9F01000000000074B7010000000000DECF01000000000048E8010000000000B2000200000000001C190200000000008631020000000000F0490200000000005A62020000000000C47A0200000000002E9302000000000098AB02000000000002C40200000000006CDC020000000000D6F4020000000000410D030000000000') AS prov_ps1 from partsupp) ps,nation,region,
(select min(ps_supplycost) as min_supplycost, bit_or_ints(prov_ps2) as prov_ps2, ps_partkey from (select ps_partkey, ps_suppkey, ps_supplycost, binsearch_ranges_pos(ps_partkey, blob '01000000000000006A18000000000000D4300000000000003E49000000000000A861000000000000127A0000000000007C92000000000000E6AA00000000000050C3000000000000BADB00000000000024F40000000000008E0C010000000000F824010000000000623D010000000000CC55010000000000366E010000000000A0860100000000000A9F01000000000074B7010000000000DECF01000000000048E8010000000000B2000200000000001C190200000000008631020000000000F0490200000000005A62020000000000C47A0200000000002E9302000000000098AB02000000000002C40200000000006CDC020000000000D6F4020000000000410D030000000000') AS prov_ps2 from partsupp) ps2, supplier, nation, region
where s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' group by ps_partkey) m
where p_partkey = ps.ps_partkey and s_suppkey = ps.ps_suppkey and p_size = 15 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE'
and ps_supplycost = m.min_supplycost and p_partkey = m.ps_partkey
order by s_acctbal desc, n_name, s_name, p_partkey
LIMIT 100) bb;
