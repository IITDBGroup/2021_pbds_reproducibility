set serveroutput on;
set echo off;
set feedback off;
set linesize 100;
set pagesize 0;
set sqlprompt '';
set trimspool on;
SET arraysize 500;

-- set start time
variable start_time VARCHAR2(200)
exec :start_time := to_char(SYSTIMESTAMP,'HH24:MI:SS.FF');

-- fail on error
WHENEVER SQLERROR EXIT FAILURE;

-- deactivate output
set termout off;




SELECT /*+ NO_RESULT_CACHE */ sum(l_extendedprice* (1 - l_discount)) AS revenue FROM
(select * from zm_lineitem where ps_l_orderkey in (
2,24,52,77,87,88,90,96,112,134,137,140,158,163,172,176,182,195,204,208,217,221,224,229,230,242,274,277,280,281,287,293,295,298,302,303,308,317,321,324,325,348,372,373,381,413,416,423,436,439,445,454,463,485,515,516,518,519,525,530,537,545,553,561,575,579,588,623,624,628,638,645,646,649,651,662,684,704,734,743,752,754,765,784,794,801,812,818,826,831,832,839,841,853,882,889,895,905,940,957,958,967,975,999,1010,1041,1079,1084,1085,1096,1111,1120,1122,1125,1127,1132,1134,1139,1171,1174,1185,1218,1232,1233,1239,1242,1271,1283,1294,1296,1303,1305,1325,1339,1343,1348,1354,1368,1370,1377,1383,1388,1392,1395,1399,1400,1418,1435,1437,1438,1447,1451,1460,1470,1479,1486,1494,1500,1505,1510,1513,1537,1548,1553,1566,1567,1577,1580,1587,1589,1590,1601,1603,1606,1617,1619,1622,1630,1633,1641
) union all select * from zm_lineitem where ps_l_orderkey in (
1658,1673,1688,1690,1713,1715,1719,1721,1722,1726,1729,1744,1761,1770,1781,1783,1787,1788,1790,
1794,1802,1804,1806,1818,1837,1841,1860,1866,1869,1872,1878,1883,1897,1910,1916,1921,1928,1935,1941,1958,1972,1979,1980,1981,1987,2003,2005,2007,2026,2028,2056,2061,2066,2069,2078,2087,2089,2105,2107,2123,2176,2185,2202,2221,2227,2280,2330,2337,2338,2349,2350,2364,2366,2372,2377,2386,2426,2432,2438,2444,2449,2457,2467,2477,2485,2490,2493,2506,2507,2510,2514,2526,2535,2545,2552,2559,2562,2570,2578,2580,2605,2612,2615,2616,2618,2619,2621,2624,2625,2629,2643,2649,2666,2671,2676,2677,2679,2700,2703,2705,2714,2735,2741,2746,2748,2753,2754,2781,2786,2791,2793,2816,2832,2837,2857,2882,2898,2899,2902,2918,2929,2932,2951,2954,2956,2965,2977,2978,2979,2981,2986,2999,3019,3027,3030,3036,3050,3052,3058,3065,3079,3083,3103,3107,3139,3151,3166,3167,3169,3185,3192,3207,3209,3219,3225,3227,3236,3238,3239,3240
) union all select * from zm_lineitem where ps_l_orderkey in (
3248,3260,3265,3273,3279,3305,3334,3349,3355,3357,3366,3370,3376,3383,3389,3395,3397,3399,3410,3418,3419,3443,3445,3446,3448,3453,3459,3462,3465,3472,3474,3482,3484,3498,3505,3508,3510,3522,3523,
3527,3534,3535,3543,3577,3591,3595,3600,3606,3613,3621,3629,3635,3651,3659,3679,3685,3687,3692,3694,3710,3712,3717,3738,3740,3744,3754,3799,3805,3806,3812,3819,3821,3832,3834,3836,3868,3877,3885,3886,3898,3903,3908,3909,3910,3916,3928,3932,3945,3957,3958,3961,3967,3969,4008,4014,4015,4030,4054,4061,4063,4074,4097,4098,4100,4102,4107,4116,4121,4127,4144,4152,4157,4174,4176,4179,4185,4186,4221,4223,4228,4241,4245,4255,4262,4269,4280,4284,4290,4304,4330,4361,4381,4401,4402,4404,4421,4432,4433,4436,4440,4443,4444,4454,4455,4461,4462,4494,4502,4523,4524,4531,4538,4545,4546,4554,4558,4565,4591,4630,4639,4661,4665,4669,4677,4694,4699,4701,4706,4709,4717,4733,4747,4762,4763,4771,4772,4773,4796,4805,4808
) union all select * from zm_lineitem where ps_l_orderkey in (
4834,4844,4845,4848,4850,4861,4872,4875,4876,4884,4886,4907,4928,4939,4965,4970,4972,4973,4975,4986,4988,4998,5006,5018,5021,5025,5027,5028,5070,5097,5102,5105,5114,5119,5124,5182,5186,5196,5199,5233,5240,5241,5246,5247,5254,5265,5271,5281,5282,5287,5324,5329,5355,5356,5362,5377,5390,5405,5419,
5423,5425,5431,5445,5455,5463,5475,5478,5481,5488,5496,5497,5502,5520,5530,5536,5542,5546,5556,5578,5587,5603,5606,5627,5642,5649,5680,5683,5699,5711,5716,5722,5738,5745,5749,5763,5773,5782,5800,5801,5812,5817,5829,5847,5850,5861,5865,5877,5888,5894,5909,5911,5920,5926,5930,5932,5939,5940,5961,5984,5995,6008,6009,6013,6017,6023,6029,6035,6057,6063,6066,6084,6107,6125,6127,6159,6175,6176,6178,6192,6193,6195,6203,6209,6214,6215,6222,6223,6234,6235,6253,6263,6265,6272,6288,6292,6305,6308,6311,6313,6325,6354,6362,6363,6364,6368,6370,6377,6397,6398,6404,6410,6420,6427,6429,6439,6454,6486,6488,6510,6537
) union all select * from zm_lineitem where ps_l_orderkey in (
6539,6559,6571,6580,6585,6597,6600,6603,6604,6606,6610,6612,6622,6625,6646,6657,6661,6668,6673,6705,6711,6723,6724,6728,6732,6738,6744,6748,6772,6776,6790,6791,6800,6815,6820,6822,6834,6840,6847,6848,6850,6884,6885,6895,6897,6902,6904,6915,6919,6950,6952,6955,6957,6962,6979,6988,7000,7008,7009,7014,7024,7035,7036,7040,7045,7066,7068,7073,7075,7102,7114,7119,7121,7131,7152,7154,7166,7169,7172,
7173,7186,7199,7207,7210,7226,7231,7243,7273,7282,7293,7335,7352,7356,7364,7400,7401,7408,7412,7414,7417,7423,7431,7432,7454,7461,7463,7481,7487,7494,7503,7518,7520,7547,7568,7574,7610,7628,7633,7635,7659,7690,7702,7715,7729,7730,7734,7736,7740,7747,7748,7754,7766,7777,7783,7787,7812,7819,7829,7865,7870,7911,7922,7931,7937,7947,7962,7966,7972,7982,7984,7985,8002,8009,8039,8056,8059,8070,8077,8091,8098,8101,8110,8112,8118,8125,8132,8137,8174,8177,8178,8181,8186,8188,8189,8198,8210,8227,8236,8239,8276
) union all select * from zm_lineitem where ps_l_orderkey in (
8279,8286,8298,8307,8310,8311,8315,8340,8348,8351,8360,8361,8362,8370,8371,8392,8401,8403,8420,8441,8447,8452,8477,8485,8513,8519,8522,8532,8536,8540,8543,8553,8556,8561,8567,8576,8577,8593,8605,8631,8639,8644,8657,8658,8685,8687,8695,8703,8705,8711,8724,8736,8745,8746,8750,8780,8787,8798,8807,8839,8844,8845,8865,8878,8897,8917,8924,8943,8944,8946,8957,8962,8973,8983,8996,9007,9035,9044,9046,9047,9064,9068,9083,9092,9099,9103,9111,9124,9126,9129,9173,9180,9181,9185,9231,9245,9254,9256,9283,
9286,9298,9310,9326,9328,9332,9335,9336,9341,9350,9360,9368,9374,9383,9385,9386,9396,9397,9405,9420,9421,9424,9432,9438,9453,9464,9488,9495,9525,9531,9534,9547,9552,9555,9563,9564,9565,9584,9590,9625,9628,9636,9648,9654,9655,9661,9664,9667,9672,9677,9686,9721,9757,9771,9776,9780,9792,9801,9804,9810,9816,9817,9823,9824,9835,9845,9865,9871,9875,9877,9908,9918,9921,9934,9943,9945,9946,9976,9986,9987,9999
)),
(select * from zm_part where ps_p_partkey in (
16,20,33,55,63,86,87,92,107,116,145,172,175,179,182,191,203,229,231,243,255,298,305,319,327,335,336,337,340,341,344,352,358,364,371,429,431,436,438,441,445,457,466,485,488,517,525,530,539,541,556,572,579,601,618,621,629,646,656,660,670,671,678,704,706,722,728,747,752,755,768,772,774,777,818,822,838,846,849,859,861,864,875,883,887,897,913,945,958,971,978,980,981,987,995,1010,1015,1022,1024,1026,1027,1056,1079,1084,1103,1117,1126,1131,1137,1148,1155,1213,1225,1226,1257,1280,1312,1317,1327,1337,1349,1350,1354,1382,1387,1393,1396,1401,1424,1426,1435,1442,1444,1456,1463,1471,1490,1494,1499,1502,1515,1516,1518,1519,1530,1531,1546,1557,1569,1585,1589,1592,1593,1595,1602,1630,1634,1640,1642,1643,1645,1652,1655,1663
) union all select * from zm_part where ps_p_partkey in (
1680,1686,1692,1707,1727,1739,1741,1747,1772,1786,1796,1807,1812,1813,1816,1827,1830,1832,1841,1852,1853,1860,1890,1896,1897,1898,1900,1904,1905,1917,1921,1931,1944,1962,1971,
1987,1992,1996,2056,2059,2060,2064,2084,2086,2090,2097,2121,2123,2126,2129,2131,2134,2135,2138,2144,2157,2158,2171,2203,2218,2221,2225,2231,2246,2272,2278,2285,2287,2291,2305,2357,2387,2394,2407,2422,2423,2425,2430,2440,2446,2454,2465,2472,2473,2475,2477,2479,2485,2506,2528,2549,2604,2615,2626,2649,2652,2657,2664,2682,2688,2694,2717,2722,2729,2737,2744,2755,2762,2769,2778,2782,2791,2793,2796,2818,2832,2834,2840,2849,2861,2888,2891,2903,2905,2914,2915,2923,2925,2939,2949,2951,2964,2967,2970,2971,2978,2981,2988,3004,3022,3024,3026,3034,3035,3047,3067,3102,3103,3105,3108,3115,3117,3120,3121,3139,3141,3170,3181,3187,3192,3196,3197,3198,3229
) union all select * from zm_part where ps_p_partkey in (
3233,3235,3238,3243,3245,3257,3268,3280,3296,3338,3344,3351,3378,3396,3406,3419,3421,3442,3448,3452,3454,3463,3466,3484,3492,3506,3512,3516,3532,3543,3556,3605,3611,3621,3622,3646,3667,3676,3685,3688,3691,3698,3703,3712,3715,3723,3771,3776,3784,3797,3805,3816,3831,3835,3838,3842,3857,3858,3859,3867,3871,3881,3882,3884,3896,3899,3904,3907,3912,3913,3915,
3925,3951,3952,3976,3992,3995,3998,4008,4026,4044,4064,4074,4075,4076,4077,4090,4111,4137,4138,4139,4156,4190,4191,4220,4241,4251,4259,4260,4267,4277,4284,4285,4289,4302,4317,4331,4362,4389,4391,4392,4402,4413,4415,4422,4429,4431,4454,4458,4459,4472,4474,4501,4514,4523,4525,4526,4530,4539,4553,4554,4555,4562,4566,4601,4619,4623,4655,4666,4675,4687,4693,4717,4725,4748,4760,4761,4762,4763,4788,4804,4818,4838,4849,4854,4875,4877,4910,4916,4921,4925,4935,4945,4946
) union all select * from zm_part where ps_p_partkey in (
4948,4959,4979,4986,4987,4990,4993,5003,5008,5018,5024,5026,5050,5064,5071,5077,5094,5098,5101,5118,5120,5133,5137,5140,5161,5166,5187,5189,5206,5224,5227,5228,5270,5271,5277,5282,5298,5316,5322,5329,5343,5347,5351,5358,5385,5430,5432,5445,5446,5447,5456,5468,5483,5485,5501,5520,5528,5558,5573,5583,5586,5592,5602,5609,5613,5646,5651,5653,5691,5697,5709,5733,5735,5743,5755,5784,5787,5814,5827,5844,5848,5857,5858,5859,5865,5868,5885,5902,5905,5918,5930,5938,5950,5952,5960,5986,6006,6010,6012,6014,6022,6034,6039,6044,6055,6062,6068,
6079,6082,6094,6101,6111,6114,6152,6155,6156,6162,6183,6191,6193,6194,6198,6200,6201,6205,6221,6223,6239,6255,6262,6272,6284,6303,6307,6310,6320,6321,6334,6351,6360,6367,6383,6389,6399,6403,6411,6419,6420,6428,6431,6433,6435,6477,6479,6498,6505,6508,6510,6514,6515,6516,6517,6525,6528
) union all select * from zm_part where ps_p_partkey in (
6552,6558,6572,6575,6581,6618,6638,6639,6649,6652,6679,6693,6696,6697,6699,6701,6722,6729,6767,6771,6794,6796,6809,6812,6827,6840,6844,6858,6867,6868,6870,6875,6876,6879,6886,6889,6901,6908,6934,6937,6944,6952,6956,6972,6981,6984,6991,6993,6995,6999,7005,7008,7010,7012,7025,7037,7073,7092,7095,7130,7131,7137,7139,7147,7162,7164,7165,7188,7191,7194,7211,7213,7225,7246,7250,7261,7263,7270,7272,7308,7310,7317,7357,7362,7366,7370,7402,7409,7413,7414,7417,7431,7436,7457,7470,7476,7487,7493,7506,7519,7536,7543,7548,7564,7565,7569,7570,7590,7591,7595,7608,7611,7652,7669,7670,7688,7716,7726,7732,7758,7767,7771,7809,7811,7828,7833,7834,7835,7879,7887,7891,7899,7901,7910,7929,7939,7966,7977,8006,8011,8017,8022,8032,
8048,8079,8082,8096,8098,8107,8132,8151,8162,8171,8176,8188,8194,8206,8209,8249,8270,8277,8296,8298,8315
) union all select * from zm_part where ps_p_partkey in (
8321,8354,8364,8367,8373,8379,8383,8386,8399,8407,8408,8416,8439,8445,8452,8455,8463,8465,8477,8484,8486,8525,8526,8530,8546,8558,8560,8564,8571,8579,8605,8618,8620,8631,8644,8649,8655,8662,8685,8695,8698,8702,8706,8760,8761,8774,8775,8777,8780,8782,8805,8806,8809,8812,8816,8821,8823,8824,8827,8851,8860,8863,8891,8916,8918,8923,8933,8936,8951,8953,8964,8981,8989,9014,9033,9039,9050,9067,9073,9074,9116,9122,9124,9146,9148,9149,9151,9154,9157,9162,9171,9172,9186,9197,9200,9201,9214,9236,9249,9273,9274,9288,9294,9305,9351,9356,9360,9362,9373,9397,9406,9410,9420,9455,9465,9473,9483,9492,9519,9523,9527,9532,9551,9553,9566,9576,9578,9580,9583,9585,9588,9591,9601,9604,9615,9626,9630,9639,9641,9675,9689,9698,9700,9703,9706,9722,9746,9753,9754,9775,9778,9782,9784,9802,9806,9815,9834,9836,9892,9896,9904,9915,9924,9929
) union all select * from zm_part where ps_p_partkey in (
9930,9933,9947,9961))
WHERE (p_partkey = l_partkey AND p_Brand = 'Brand#12' AND (p_container = 'SM CASE' OR p_container = 'SM BOX' OR p_container = 'SM PACK' OR p_container = 'SM PKG')
AND l_quantity >= 1 AND l_quantity <= 1 + 10 AND p_size >= 1 AND p_size <= 5 AND (l_shipmode ='AIR' OR l_shipmode = 'AIR REG')
AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey AND p_Brand = 'Brand#23'
AND (p_container = 'MED BAG' OR p_container = 'MED BOX' OR p_container = 'MED PKG' OR p_container = 'MED PACK') AND l_quantity >= 10
AND l_quantity <= 10 + 10 AND p_size >= 1 AND p_size <= 10 AND (l_shipmode ='AIR' OR l_shipmode = 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') OR (p_partkey = l_partkey
AND p_Brand = 'Brand#34' AND (p_container = 'LG CASE' OR p_container = 'LG BOX' OR p_container = 'LG PACK' OR p_container = 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 20 + 10
AND p_size >= 1 AND p_size <= 15 AND (l_shipmode ='AIR' OR l_shipmode = 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON');


            -- activate output
set termout on;

-- set finish time and output
variable finish_time VARCHAR2(200)
exec :finish_time := to_char(SYSTIMESTAMP,'HH24:MI:SS.FF');
SELECT (EXTRACT(SECOND from to_timestamp(:finish_time, 'HH24:MI:SS.FF'))-extract(SECOND from to_timestamp(:start_time, 'HH24:MI:SS.FF')))
        + ((EXTRACT(MINUTE from to_timestamp(:finish_time, 'HH24:MI:SS.FF'))-extract(MINUTE from to_timestamp(:start_time, 'HH24:MI:SS.FF'))) * 60)
            + ((EXTRACT(HOUR from to_timestamp(:finish_time, 'HH24:MI:SS.FF'))-extract(HOUR from to_timestamp(:start_time, 'HH24:MI:SS.FF'))) * 3600)
                + ((EXTRACT(DAY from to_timestamp(:finish_time, 'HH24:MI:SS.FF'))-extract(DAY from to_timestamp(:start_time, 'HH24:MI:SS.FF'))) * 86400)
                    AS t from dual;

                quit;
