select * from (select count(p.p_id) as rate, t.t_id as tagname from tags t, posttags_b1 pt, posts_bb1 p where t.t_id = pt.t_id and p.p_id = pt.p_id and p.p_creationdate < '2010-06-01' and p.p_creationdate > '2010-05-01' group by t.t_id) as rate, (select * from (select count(p.p_id) as num, t.t_id as tagname from tags t, posttags_b1 pt, posts_bb1 p where t.t_id = pt.t_id and p.p_id = pt.p_id group by t.t_id) a where num > 1000000) as num where rate.tagname = num.tagname;
