select * from (select count(p.p_id) as rate, t.t_id as tagname from tags t, (select * from posttags_b1 where t_id <@ '{1,26,1383,1390}'::int[]) pt, posts_bb1 p where t.t_id = pt.t_id and p.p_id = pt.p_id and p.p_creationdate < '2010-06-01' and p.p_creationdate > '2010-05-01' group by t.t_id) as rate, (select * from (select * from q3_v3 where tagname <@ '{1,26,1383,1390}'::int[]) a where num > 800) as num where rate.tagname = num.tagname;
