select bit_or_ints(prov_s1) as prov_s1, bit_or_blob(prov_l1) as prov_l1, bit_or_blob(prov_l2) as prov_l2 from (
select s_suppkey, s_name, s_address, s_phone, total_revenue, prov_s1, prov_l1, prov_l2
from
(select  s_suppkey, s_name, s_address, s_phone, binsearch_ranges_pos(s_suppkey, blob '0100000000000000E90B0000000000000D180000000000001C240000000000001C30000000000000263C0000000000004F480000000000007654000000000000F5600000000000006A6D0000000000000C7A000000000000E9850000000000000A920000000000002B9E0000000000006EAA0000000000008DB600000000000038C300000000000083CF00000000000022DB00000000000016E80000000000007BF4000000000000E100010000000000C90C010000000000111901000000000039250100000000004931010000000000B13D010000000000214A0100000000000856010000000000DE61010000000000BA6E010000000000A37A010000000000A186010000000000') AS prov_s1 from supplier) ss1,
(select supplier_no, total_revenue, prov_l1, prov_l2 from (
    select l_suppkey as supplier_no, sum(l_extendedprice * (1 - l_discount)) as total_revenue, bit_or_ints(prov_l1) as prov_l1
    from (select l_discount,l_extendedprice,l_suppkey,l_shipdate, binsearch_ranges_pos(l_suppkey, blob '0100000000000000A70C000000000000FE180000000000000E2500000000000034310000000000007D3D000000000000F7490000000000008855000000000000D961000000000000216E000000000000357A000000000000BC85000000000000EA91000000000000239F00000000000026AB00000000000076B7000000000000E1C300000000000033D00000000000002ADD000000000000B0E9000000000000D9F4000000000000AC000100000000005D0C010000000000F4180100000000008B25010000000000A431010000000000C23D010000000000C34901000000000028560100000000000963010000000000A76E010000000000AC7A010000000000A186010000000000') AS prov_l1
         from lineitem) ll1
    where l_shipdate >= '1996-12-01' and l_shipdate < '1997-03-01'
    group by l_suppkey) l1,
    (select max(total_revenue) as total_revenue2 , bit_or_blob(prov_l2) as prov_l2
    from (select l_suppkey as supplier_no, sum(l_extendedprice * (1 - l_discount)) as total_revenue, bit_or_ints(prov_l2) as prov_l2
          from (select l_discount,l_extendedprice,l_suppkey,l_shipdate,binsearch_ranges_pos(l_suppkey, blob '0100000000000000A70C000000000000FE180000000000000E2500000000000034310000000000007D3D000000000000F7490000000000008855000000000000D961000000000000216E000000000000357A000000000000BC85000000000000EA91000000000000239F00000000000026AB00000000000076B7000000000000E1C300000000000033D00000000000002ADD000000000000B0E9000000000000D9F4000000000000AC000100000000005D0C010000000000F4180100000000008B25010000000000A431010000000000C23D010000000000C34901000000000028560100000000000963010000000000A76E010000000000AC7A010000000000A186010000000000') AS prov_l2
                from lineitem) ll2
                where l_shipdate >= '1996-12-01' and l_shipdate < '1997-03-01'
                group by l_suppkey) l2
      ) l3
where l1.total_revenue = l3.total_revenue2) l5
where s_suppkey = supplier_no order by s_suppkey) f;
