select bit_or_blob(prov_c1) as prov_c1, bit_or_blob(prov_l1) as prov_l1, bit_or_blob(prov_o1) as prov_o1  from (
select * from (select * from (
select l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority, bit_or_ints(prov_c1) as prov_c1, bit_or_ints(prov_l1) as prov_l1, bit_or_ints(prov_o1) as prov_o1
from
(select l_orderkey, l_shipdate, l_extendedprice, l_discount, binsearch_ranges_pos(l_orderkey, (SELECT bounds_to_blob(b) FROM (VALUES (1),(186977),(375301),(562278),(749568),(937314),(1125348),(1312711),(1500738),(1687907),(1874917),(2062599),(2250438),(2438022),(2626021),(2813156),(3000961),(3188294),(3375589),(3562148),(3749957),(3937667),(4125286),(4312550),(4500354),(4687457),(4875014),(5062566),(5250567),(5437926),(5625987),(5813189),(6000001)) AS g(b))) AS prov_l1 from lineitem) ll1,
(select o_shippriority,o_orderdate,o_orderkey,o_custkey, binsearch_ranges_pos(o_orderkey, (SELECT bounds_to_blob(b) FROM (VALUES (1),(187491),(374982),(562497),(749988),(937479),(1124994),(1312485),(1500000),(1687491),(1874982),(2062497),(2249988),(2437479),(2624994),(2812485),(3000000),(3187491),(3374982),(3562497),(3749988),(3937479),(4124994),(4312485),(4500000),(4687491),(4874982),(5062497),(5249988),(5437479),(5624994),(5812485),(6000001)) AS g(b))) AS prov_o1 from orders) o1,
(select c_custkey, c_mktsegment, binsearch_ranges_pos(c_custkey, (SELECT bounds_to_blob(b) FROM (VALUES (1),(4688),(9376),(14064),(18752),(23440),(28128),(32816),(37504),(42192),(46880),(51568),(56256),(60944),(65632),(70320),(75008),(79695),(84382),(89069),(93756),(98443),(103130),(107817),(112504),(117191),(121878),(126565),(131252),(135939),(140626),(145313),(150001)) AS g(b))) AS prov_c1 from customer ) cc1
where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' group by l_orderkey, o_orderdate, o_shippriority) l2 order by revenue desc, o_orderdate) l1 limit 10
) f;
