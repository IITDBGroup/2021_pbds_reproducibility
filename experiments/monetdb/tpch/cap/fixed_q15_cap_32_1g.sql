select bit_or_ints(prov_s1) as prov_s1, bit_or_blob(prov_l1) as prov_l1, bit_or_blob(prov_l2) as prov_l2 from (
select s_suppkey, s_name, s_address, s_phone, total_revenue, prov_s1, prov_l1, prov_l2
from
(select  s_suppkey, s_name, s_address, s_phone, binsearch_ranges_pos(s_suppkey, blob '010000000000000039010000000000007102000000000000AA03000000000000E2040000000000001B0600000000000053070000000000008C08000000000000C409000000000000FD0A000000000000350C0000000000006E0D000000000000A60E000000000000DF0F000000000000171100000000000050120000000000008813000000000000C114000000000000F91500000000000032170000000000006A18000000000000A319000000000000DB1A000000000000141C0000000000004C1D000000000000851E000000000000BD1F000000000000F6200000000000002E2200000000000067230000000000009F24000000000000D8250000000000001127000000000000') AS prov_s1 from supplier) ss1,
(select supplier_no, total_revenue, prov_l1, prov_l2 from (
    select l_suppkey as supplier_no, sum(l_extendedprice * (1 - l_discount)) as total_revenue, bit_or_ints(prov_l1) as prov_l1
    from (select l_discount,l_extendedprice,l_suppkey,l_shipdate, binsearch_ranges_pos(l_suppkey, blob '010000000000000039010000000000007302000000000000AA03000000000000E1040000000000001B0600000000000053070000000000008C08000000000000C309000000000000FC0A000000000000350C0000000000006D0D000000000000A70E000000000000E00F000000000000191100000000000051120000000000008913000000000000C214000000000000FB1500000000000033170000000000006C18000000000000A319000000000000DC1A000000000000141C0000000000004C1D000000000000851E000000000000BD1F000000000000F6200000000000002E220000000000006723000000000000A024000000000000D8250000000000001127000000000000') AS prov_l1
         from lineitem) ll1
    where l_shipdate >= '1996-12-01' and l_shipdate < '1997-03-01'
    group by l_suppkey) l1,
    (select max(total_revenue) as total_revenue2 , bit_or_blob(prov_l2) as prov_l2
    from (select l_suppkey as supplier_no, sum(l_extendedprice * (1 - l_discount)) as total_revenue, bit_or_ints(prov_l2) as prov_l2
          from (select l_discount,l_extendedprice,l_suppkey,l_shipdate,binsearch_ranges_pos(l_suppkey, blob '010000000000000039010000000000007302000000000000AA03000000000000E1040000000000001B0600000000000053070000000000008C08000000000000C309000000000000FC0A000000000000350C0000000000006D0D000000000000A70E000000000000E00F000000000000191100000000000051120000000000008913000000000000C214000000000000FB1500000000000033170000000000006C18000000000000A319000000000000DC1A000000000000141C0000000000004C1D000000000000851E000000000000BD1F000000000000F6200000000000002E220000000000006723000000000000A024000000000000D8250000000000001127000000000000') AS prov_l2
                from lineitem) ll2
                where l_shipdate >= '1996-12-01' and l_shipdate < '1997-03-01'
                group by l_suppkey) l2
      ) l3
where l1.total_revenue = l3.total_revenue2) l5
where s_suppkey = supplier_no order by s_suppkey) f;
