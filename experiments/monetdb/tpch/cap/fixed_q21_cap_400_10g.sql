select bit_or_blob(prov_s1) as prov_s1, bit_or_blob(prov_l1) as prov_l1 from (
select
	s_name,
	count(*) as numwait,
  bit_or_ints(prov_s1) as prov_s1,
  bit_or_blob(prov_l1) as prov_l1
from
		(select  s_nationkey, s_name, s_suppkey, binsearch_ranges_pos(s_suppkey, blob '0100000000000000FA00000000000000F401000000000000EE02000000000000E803000000000000E204000000000000DC05000000000000D606000000000000D007000000000000CA08000000000000C409000000000000BE0A000000000000B80B000000000000B20C000000000000AC0D000000000000A60E000000000000A00F0000000000009A1000000000000094110000000000008E12000000000000881300000000000082140000000000007C15000000000000761600000000000070170000000000006A1800000000000064190000000000005E1A000000000000581B000000000000521C0000000000004C1D000000000000461E000000000000401F0000000000003A2000000000000034210000000000002E22000000000000282300000000000022240000000000001C25000000000000162600000000000010270000000000000A280000000000000429000000000000FE29000000000000F82A000000000000F22B000000000000EC2C000000000000E62D000000000000E02E000000000000DA2F000000000000D430000000000000CE31000000000000C832000000000000C233000000000000BC34000000000000B635000000000000B036000000000000AA37000000000000A4380000000000009E39000000000000983A000000000000923B0000000000008C3C000000000000863D000000000000803E0000000000007A3F00000000000074400000000000006E41000000000000684200000000000062430000000000005C44000000000000564500000000000050460000000000004A4700000000000044480000000000003E49000000000000384A000000000000324B0000000000002C4C000000000000264D000000000000204E0000000000001A4F00000000000014500000000000000E5100000000000008520000000000000253000000000000FC53000000000000F654000000000000F055000000000000EA56000000000000E457000000000000DE58000000000000D859000000000000D25A000000000000CC5B000000000000C65C000000000000C05D000000000000BA5E000000000000B45F000000000000AE60000000000000A861000000000000A2620000000000009C63000000000000966400000000000090650000000000008A6600000000000084670000000000007E680000000000007869000000000000726A0000000000006C6B000000000000666C000000000000606D0000000000005A6E000000000000546F0000000000004E70000000000000487100000000000042720000000000003C73000000000000367400000000000030750000000000002A7600000000000024770000000000001E780000000000001879000000000000127A0000000000000C7B000000000000067C000000000000007D000000000000FA7D000000000000F47E000000000000EE7F000000000000E880000000000000E281000000000000DC82000000000000D683000000000000D084000000000000CA85000000000000C486000000000000BE87000000000000B888000000000000B289000000000000AC8A000000000000A68B000000000000A08C0000000000009A8D000000000000948E0000000000008E8F000000000000889000000000000082910000000000007C92000000000000769300000000000070940000000000006A9500000000000064960000000000005E97000000000000589800000000000052990000000000004C9A000000000000469B000000000000409C0000000000003A9D000000000000349E0000000000002E9F00000000000028A000000000000022A10000000000001CA200000000000016A300000000000010A40000000000000AA500000000000004A6000000000000FEA6000000000000F8A7000000000000F2A8000000000000ECA9000000000000E6AA000000000000E0AB000000000000DAAC000000000000D4AD000000000000CEAE000000000000C8AF000000000000C2B0000000000000BCB1000000000000B6B2000000000000B0B3000000000000AAB4000000000000A4B50000000000009EB600000000000098B700000000000092B80000000000008CB900000000000086BA00000000000080BB0000000000007ABC00000000000074BD0000000000006EBE00000000000068BF00000000000062C00000000000005CC100000000000056C200000000000050C30000000000004AC400000000000044C50000000000003EC600000000000038C700000000000032C80000000000002CC900000000000026CA00000000000020CB0000000000001ACC00000000000014CD0000000000000ECE00000000000008CF00000000000002D0000000000000FCD0000000000000F6D1000000000000F0D2000000000000EAD3000000000000E4D4000000000000DED5000000000000D8D6000000000000D2D7000000000000CCD8000000000000C6D9000000000000C0DA000000000000BADB000000000000B4DC000000000000AEDD000000000000A8DE000000000000A2DF0000000000009CE000000000000096E100000000000090E20000000000008AE300000000000084E40000000000007EE500000000000078E600000000000072E70000000000006CE800000000000066E900000000000060EA0000000000005AEB00000000000054EC0000000000004EED00000000000048EE00000000000042EF0000000000003CF000000000000036F100000000000030F20000000000002AF300000000000024F40000000000001EF500000000000018F600000000000012F70000000000000CF800000000000006F900000000000000FA000000000000FAFA000000000000F4FB000000000000EEFC000000000000E8FD000000000000E2FE000000000000DCFF000000000000D600010000000000D001010000000000CA02010000000000C403010000000000BE04010000000000B805010000000000B206010000000000AC07010000000000A608010000000000A0090100000000009A0A010000000000940B0100000000008E0C010000000000880D010000000000820E0100000000007C0F010000000000761001000000000070110100000000006A1201000000000064130100000000005E14010000000000581501000000000052160100000000004C17010000000000461801000000000040190100000000003A1A010000000000341B0100000000002E1C010000000000281D010000000000221E0100000000001C1F010000000000162001000000000010210100000000000A220100000000000423010000000000FE23010000000000F824010000000000F225010000000000EC26010000000000E627010000000000E028010000000000DA29010000000000D42A010000000000CE2B010000000000C82C010000000000C22D010000000000BC2E010000000000B62F010000000000B030010000000000AA31010000000000A4320100000000009E33010000000000983401000000000092350100000000008C36010000000000863701000000000080380100000000007A39010000000000743A0100000000006E3B010000000000683C010000000000623D0100000000005C3E010000000000563F01000000000050400100000000004A4101000000000044420100000000003E43010000000000384401000000000032450100000000002C46010000000000264701000000000020480100000000001A49010000000000144A0100000000000E4B010000000000084C010000000000024D010000000000FC4D010000000000F64E010000000000F04F010000000000EA50010000000000E451010000000000DE52010000000000D853010000000000D254010000000000CC55010000000000C656010000000000C057010000000000BA58010000000000B459010000000000AE5A010000000000A85B010000000000A25C0100000000009C5D010000000000965E010000000000905F0100000000008A6001000000000084610100000000007E62010000000000786301000000000072640100000000006C65010000000000666601000000000060670100000000005A6801000000000054690100000000004E6A010000000000486B010000000000426C0100000000003C6D010000000000366E010000000000306F0100000000002A7001000000000024710100000000001E72010000000000187301000000000012740100000000000C7501000000000006760100000000000077010000000000FA77010000000000F478010000000000EE79010000000000E87A010000000000E27B010000000000DC7C010000000000D67D010000000000D07E010000000000CA7F010000000000C480010000000000BE81010000000000B882010000000000B283010000000000AC84010000000000A685010000000000A186010000000000') AS prov_s1 from supplier) s1,
	(select l_orderkey, l_suppkey, l_receiptdate, l_commitdate, prov_l1 from (
select l_orderkey, l_suppkey,l_receiptdate, l_commitdate, sum(dateb) as datebc, bit_or_ints(prov_l1) as prov_l1 from (
select  l1.l_orderkey, l1.l_suppkey, l1.l_receiptdate, l1.l_commitdate, case when l2.l_receiptdate > l2.l_commitdate then  1 else  0 end as dateb, prov_l1 from ( select l_quantity,l_returnflag,l_orderkey, l_shipdate, l_extendedprice, l_commitdate,l_receiptdate,l_suppkey,l_discount, binsearch_ranges_pos(l_orderkey, blob '01000000000000006538020000000000A696040000000000602A070000000000618809000000000024EF0B000000000080F00E0000000000247C110000000000A4121400000000004184160000000000E31819000000000041F41B0000000000456F1E0000000000C7BE2000000000008730230000000000A4D8250000000000A310280000000000C54B2A0000000000C0E22C0000000000A5E62F0000000000E21E3200000000008798340000000000040D370000000000E06B390000000000A2F43B0000000000A6963E0000000000014B41000000000062C3430000000000A25C46000000000082AA48000000000025FC4A0000000000E42A4D0000000000E6694F000000000063C05100000000008024540000000000841B5600000000004358580000000000808A5A000000000007BA5C0000000000C6FD5E00000000008117610000000000E2596300000000004554650000000000C6A067000000000086A869000000000060DC6B0000000000A1026E00000000000264700000000000A3AC72000000000045EA7400000000006324770000000000666279000000000040CC7B0000000000E4287E000000000044458000000000000281820000000000E1BE840000000000A1FF86000000000040FC880000000000E12A8B0000000000C73C8D0000000000E4A78F000000000000E59100000000002506940000000000C357960000000000C28C98000000000000A19A0000000000E1809C0000000000A6DD9E00000000006606A100000000008447A30000000000668CA50000000000C3D4A70000000000E3E5A90000000000434AAC0000000000E1C9AE0000000000C2D4B0000000000041D4B20000000000E7FDB40000000000646CB7000000000066C5B900000000004703BC00000000008161BE00000000006484C000000000006723C30000000000248DC50000000000A6DDC700000000008737CA0000000000E37ACC0000000000A5D0CE0000000000C026D100000000002772D3000000000062BBD50000000000C0F3D700000000000315DA0000000000C448DC0000000000239EDE00000000008645E10000000000417DE3000000000045C1E5000000000003DFE70000000000E230EA00000000000096EC000000000024B5EE00000000004375F00000000000A28CF2000000000064BBF400000000008114F70000000000C785F90000000000E1DAFB000000000023F5FD00000000002100000100000000A7F1010100000000A241040100000000E08E060100000000E5EE080100000000C1070B0100000000C6310D010000000085680F01000000002482110100000000A3C8130100000000E3E815010000000025DE170100000000A3C9190100000000442B1C0100000000E7381E010000000080AC200100000000C7EC2201000000004664250100000000E794270100000000642C2A0100000000C28C2C010000000002CA2E01000000004000310100000000275F330100000000C6B23501000000006034380100000000627D3A010000000005B33C010000000044A73E010000000081B6400100000000E4E4420100000000C363450100000000E1BE47010000000060124A0100000000267A4C0100000000C3B74E01000000006709510100000000061A5301000000000192550100000000C4C657010000000000315A0100000000C27D5C010000000041A25E0100000000811061010000000046BA63010000000081BA650100000000C715680100000000E5806A010000000025FD6C0100000000A0106F01000000006721710100000000068773010000000064E3750100000000E40C780100000000A33C7A010000000026E57C010000000042477F0100000000268181010000000026F18301000000002736860100000000A16C880100000000228F8A0100000000C7EF8C0100000000A2858F0100000000A295910100000000C52D940100000000A66A960100000000C4BD98010000000007D09A010000000047499D010000000040929F0100000000E3AFA10100000000610DA40100000000E5DDA50100000000C709A80100000000A769AA0100000000A5F9AC01000000002193AF01000000004329B20100000000A64EB4010000000082A7B60100000000A3FAB80100000000837DBB010000000027CEBD0100000000E23CC00100000000224DC20100000000233DC40100000000A458C601000000006474C8010000000004CECA01000000004278CD0100000000A58DCF010000000060EAD10100000000A375D40100000000E299D60100000000E1CAD801000000004754DB01000000008191DD0100000000C2B8DF0100000000C229E20100000000604AE401000000008197E6010000000047B6E80100000000E6F9EA01000000002432ED0100000000C650EF010000000064C9F10100000000C5E6F30100000000862DF601000000008385F80100000000A6B7FA01000000004412FD0100000000C60CFF0100000000E70D010200000000E7D60302000000002741060200000000235B080200000000E6770A020000000026C20C020000000026340F0200000000E5DC110200000000407B140200000000C0B6160200000000A0B9180200000000C3111B0200000000E36B1D020000000061C01F0200000000475522020000000025F8230200000000A734260200000000827C280200000000C65C2A0200000000242B2C0200000000064F2E0200000000866D30020000000040F4320200000000A01C350200000000055F37020000000027B039020000000061F03B0200000000E4093E0200000000844E40020000000026CB420200000000A2FE440200000000E14B47020000000022F3490200000000A3224C020000000067504E0200000000C4C25002000000000347530200000000448E550200000000413258020000000043C45A0200000000E4C65C020000000001275F02000000004520610200000000C453630200000000A6D8650200000000666968020000000025BB6A0200000000E7C36C0200000000C0FD6E0200000000C32F710200000000656473020000000000CC750200000000A749780200000000C23E7A0200000000A23E7C020000000067AE7E0200000000833A81020000000062B28302000000000609860200000000071F880200000000C55E8A0200000000E3D38C0200000000416E8F0200000000E7C391020000000061FD9302000000008333960200000000A582980200000000E5359B0200000000C3779D020000000003F09F02000000004725A202000000008572A4020000000085D5A60200000000A2ECA80200000000A210AB0200000000805DAD0200000000C192AF0200000000E7F9B102000000000545B40200000000C2C1B60200000000C322B90200000000E6A1BB0200000000603EBE0200000000E022C00200000000A458C20200000000C2B1C4020000000001CCC602000000008100C90200000000A240CB0200000000466BCD0200000000468FCF020000000080F6D10200000000A012D402000000008270D6020000000005EFD80200000000214CDB020000000067D3DD0200000000E5D6DF02000000008040E2020000000087ACE402000000000208E702000000002631E902000000002509EB0200000000602CED02000000006175EF0200000000839EF102000000004626F4020000000084B4F60200000000C5DDF8020000000045B1FA0200000000A4E7FC0200000000E124FF0200000000018E01030000000023DF030300000000224606030000000020B9080300000000E7090B030000000025190D0300000000203E0F0300000000823E110300000000C2421303000000004396150300000000A1E617030000000085631A030000000083AB1C0300000000C7FF1E0300000000855B210300000000E3982303000000004028260300000000009B28030000000042C72A0300000000E5EB2C0300000000E3142F0300000000840231030000000063123303000000008690350300000000E59A370300000000C2A239030000000022B13B0300000000A2373E0300000000665D40030000000081AB42030000000061DD440300000000E1FA460300000000E21649030000000042ED4B030000000003AA4E0300000000A53951030000000087BE530300000000E2F8550300000000072458030000000061145A0300000000428C5C0300000000A6085F03000000000239610300000000C04963030000000027976503000000000730680300000000655C6A030000000004CF6C0300000000C7ED6E0300000000864D710300000000A07D730300000000C1CE7503000000006627780300000000066B7A030000000004F17C0300000000C63C7F0300000000A25B810300000000C0C2830300000000C2E98503000000004522880300000000E0518A0300000000816E8C0300000000A6C98E030000000041179103000000000187930300000000') AS prov_l1 from lineitem ) l1, lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey) l group by l_orderkey, l_suppkey, l_receiptdate, l_commitdate) ll where datebc = 0) l1,
	orders,
	nation
where
	s_suppkey = l1.l_suppkey
	and o_orderkey = l1.l_orderkey
	and o_orderstatus = 'F'
	and l1.l_receiptdate > l1.l_commitdate
	and s_nationkey = n_nationkey
	and n_name = 'CHINA'
group by
	s_name
order by
	numwait desc,
	s_name
LIMIT 100) f;
