select * from (select * from (select l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority
from (select * from lineitem where ((l_orderkey >= 479815) AND (l_orderkey < 494947)) OR ((l_orderkey >= 990022) AND (l_orderkey < 1005089)) OR ((l_orderkey >= 1185255) AND (l_orderkey < 1200289)) OR ((l_orderkey >= 2295552) AND (l_orderkey < 2310695)) OR ((l_orderkey >= 2430530) AND (l_orderkey < 2460390)) OR ((l_orderkey >= 2626022) AND (l_orderkey < 2641158)) OR ((l_orderkey >= 3450470) AND (l_orderkey < 3465446)) OR ((l_orderkey >= 4875015) AND (l_orderkey < 4889927)) OR ((l_orderkey >= 5520834) AND (l_orderkey < 5535941)) ) ll,
(select * from orders where ((o_orderkey >= 480000) AND (o_orderkey < 494982)) OR ((o_orderkey >= 989988) AND (o_orderkey < 1004994)) OR ((o_orderkey >= 1184994) AND (o_orderkey < 1200000)) OR ((o_orderkey >= 2294982) AND (o_orderkey < 2309988)) OR ((o_orderkey >= 2429988) AND (o_orderkey < 2460000)) OR ((o_orderkey >= 2624994) AND (o_orderkey < 2640000)) OR ((o_orderkey >= 3449988) AND (o_orderkey < 3464994)) OR ((o_orderkey >= 4874982) AND (o_orderkey < 4889988)) OR ((o_orderkey >= 5520000) AND (o_orderkey < 5534982)) ) oo,
(select * from customer where ((c_custkey >= 31500) AND (c_custkey < 31875)) OR ((c_custkey >= 32625) AND (c_custkey < 33000)) OR ((c_custkey >= 39000) AND (c_custkey < 39375)) OR ((c_custkey >= 49500) AND (c_custkey < 49875)) OR ((c_custkey >= 59250) AND (c_custkey < 59625)) OR ((c_custkey >= 69750) AND (c_custkey < 70125)) OR ((c_custkey >= 99000) AND (c_custkey < 99375)) OR ((c_custkey >= 106500) AND (c_custkey < 106875)) OR ((c_custkey >= 131250) AND (c_custkey < 131625)) OR ((c_custkey >= 140625) AND (c_custkey < 141000)) ) cc 
where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' group by l_orderkey, o_orderdate, o_shippriority) l2 order by revenue desc, o_orderdate) l1 limit 10;
