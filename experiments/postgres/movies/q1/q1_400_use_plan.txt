                                                                                                                                                                                                                QUERY PLAN                                                                                                                                                                                                                
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1295993.21..1295993.23 rows=10 width=44) (actual time=23023.439..23023.443 rows=10 loops=1)
   ->  Sort  (cost=1295993.21..1295994.57 rows=543 width=44) (actual time=23023.437..23023.439 rows=10 loops=1)
         Sort Key: f0."AGGR_0" DESC
         Sort Method: top-N heapsort  Memory: 26kB
         ->  Subquery Scan on f0  (cost=1295737.65..1295981.47 rows=543 width=44) (actual time=22442.085..23023.287 rows=181 loops=1)
               ->  GroupAggregate  (cost=1295737.65..1295976.04 rows=543 width=44) (actual time=22442.085..23023.236 rows=181 loops=1)
                     Group Key: f0_1.movieid
                     ->  Sort  (cost=1295737.65..1295815.30 rows=31062 width=44) (actual time=22436.854..22780.305 rows=1622633 loops=1)
                           Sort Key: f0_1.movieid
                           Sort Method: quicksort  Memory: 202744kB
                           ->  Hash Join  (cost=324.62..1293419.98 rows=31062 width=44) (actual time=0.425..21908.135 rows=1622633 loops=1)
                                 Hash Cond: (f0_2.movieid = f0_1.movieid)
                                 ->  Seq Scan on ratings f0_2  (cost=0.00..1286933.19 rows=1560413 width=16) (actual time=0.028..21217.294 rows=1622633 loops=1)
                                       Filter: (((movieid >= 107) AND (movieid < 126)) OR ((movieid >= 252) AND (movieid < 269)) OR ((movieid >= 277) AND (movieid < 303)) OR ((movieid >= 308) AND (movieid < 327)) OR ((movieid >= 355) AND (movieid < 371)) OR ((movieid >= 471) AND (movieid < 481)) OR ((movieid >= 516) AND (movieid < 529)) OR ((movieid >= 569) AND (movieid < 611)) OR ((movieid >= 2551) AND (movieid < 2572)))
                                       Rows Removed by Filter: 18377630
                                 ->  Hash  (cost=317.83..317.83 rows=543 width=36) (actual time=0.384..0.384 rows=546 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 44kB
                                       ->  Bitmap Heap Scan on movies f0_1  (cost=22.72..317.83 rows=543 width=36) (actual time=0.089..0.252 rows=546 loops=1)
                                             Recheck Cond: (((movieid >= 69) AND (movieid < 138)) OR ((movieid >= 206) AND (movieid < 619)) OR ((movieid >= 2539) AND (movieid < 2608)))
                                             Heap Blocks: exact=9
                                             ->  BitmapOr  (cost=22.72..22.72 rows=546 width=0) (actual time=0.083..0.083 rows=0 loops=1)
                                                   ->  Bitmap Index Scan on movies_pkey  (cost=0.00..4.97 rows=68 width=0) (actual time=0.022..0.022 rows=68 loops=1)
                                                         Index Cond: ((movieid >= 69) AND (movieid < 138))
                                                   ->  Bitmap Index Scan on movies_pkey  (cost=0.00..12.38 rows=409 width=0) (actual time=0.041..0.041 rows=409 loops=1)
                                                         Index Cond: ((movieid >= 206) AND (movieid < 619))
                                                   ->  Bitmap Index Scan on movies_pkey  (cost=0.00..4.97 rows=68 width=0) (actual time=0.019..0.019 rows=69 loops=1)
                                                         Index Cond: ((movieid >= 2539) AND (movieid < 2608))
 Planning time: 1.918 ms
 Execution time: 23033.097 ms
(29 rows)

