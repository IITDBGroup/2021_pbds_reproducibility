SELECT bit_or(F0."PROV_movies1"::varbit) AS "PROV_movies1", bit_or(F0."PROV_ratings1"::varbit) AS "PROV_ratings1"
FROM (
SELECT F0."title" AS "title", F0."movieid" AS "movieid", F0."num_ratings" AS "num_ratings", F0."PROV_movies1" AS "PROV_movies1", F0."PROV_ratings1" AS "PROV_ratings1"
FROM (
SELECT F0."title" AS "title", F0."movieid" AS "movieid", F0."num_ratings" AS "num_ratings", F0."PROV_movies1" AS "PROV_movies1", F0."PROV_ratings1" AS "PROV_ratings1"
FROM (
SELECT F0."GROUP_1" AS "title", F0."GROUP_0" AS "movieid", F0."AGGR_0" AS "num_ratings", F0."PROV_movies1" AS "PROV_movies1", F0."PROV_ratings1" AS "PROV_ratings1"
FROM (
SELECT count(F0."rating") AS "AGGR_0", F0."movieid" AS "GROUP_0", F0."title" AS "GROUP_1", bit_or(F0."PROV_movies1"::varbit) AS "PROV_movies1", bit_or(F0."PROV_ratings1"::varbit) AS "PROV_ratings1"
FROM (
SELECT F0."movieid" AS "movieid", F0."title" AS "title", F0."genres" AS "genres", F1."userid" AS "userid", F1."movieid" AS "movieid1", F1."rating" AS "rating", F1."timestamp" AS "timestamp", F1."rdate" AS "rdate", F1."ryear" AS "ryear", F1."rmonth" AS "rmonth", F1."rday" AS "rday", F0."PROV_movies1" AS "PROV_movies1", F1."PROV_ratings1" AS "PROV_ratings1"
FROM ((
SELECT F0."movieid" AS "movieid", F0."title" AS "title", F0."genres" AS "genres", (CASE  WHEN ((F0."movieid" >= 1) AND (F0."movieid" < 430)) THEN '1000000000000000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 430) AND (F0."movieid" < 868)) THEN '0100000000000000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 868) AND (F0."movieid" < 1307)) THEN '0010000000000000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 1307) AND (F0."movieid" < 1773)) THEN '0001000000000000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 1773) AND (F0."movieid" < 2215)) THEN '0000100000000000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 2215) AND (F0."movieid" < 2642)) THEN '0000010000000000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 2642) AND (F0."movieid" < 3070)) THEN '0000001000000000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 3070) AND (F0."movieid" < 3499)) THEN '0000000100000000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 3499) AND (F0."movieid" < 3928)) THEN '0000000010000000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 3928) AND (F0."movieid" < 4357)) THEN '0000000001000000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 4357) AND (F0."movieid" < 4784)) THEN '0000000000100000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 4784) AND (F0."movieid" < 5211)) THEN '0000000000010000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 5211) AND (F0."movieid" < 5639)) THEN '0000000000001000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 5639) AND (F0."movieid" < 6065)) THEN '0000000000000100000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 6065) AND (F0."movieid" < 6503)) THEN '0000000000000010000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 6503) AND (F0."movieid" < 6931)) THEN '0000000000000001000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 6931) AND (F0."movieid" < 7357)) THEN '0000000000000000100000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 7357) AND (F0."movieid" < 8140)) THEN '0000000000000000010000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 8140) AND (F0."movieid" < 8780)) THEN '0000000000000000001000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 8780) AND (F0."movieid" < 25974)) THEN '0000000000000000000100000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 25974) AND (F0."movieid" < 26611)) THEN '0000000000000000000010000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 26611) AND (F0."movieid" < 27548)) THEN '0000000000000000000001000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 27548) AND (F0."movieid" < 31960)) THEN '0000000000000000000000100000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 31960) AND (F0."movieid" < 34065)) THEN '0000000000000000000000010000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 34065) AND (F0."movieid" < 41688)) THEN '0000000000000000000000001000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 41688) AND (F0."movieid" < 46062)) THEN '0000000000000000000000000100000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 46062) AND (F0."movieid" < 49766)) THEN '0000000000000000000000000010000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 49766) AND (F0."movieid" < 53769)) THEN '0000000000000000000000000001000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 53769) AND (F0."movieid" < 57209)) THEN '0000000000000000000000000000100000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 57209) AND (F0."movieid" < 60293)) THEN '0000000000000000000000000000010000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 60293) AND (F0."movieid" < 64427)) THEN '0000000000000000000000000000001000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 64427) AND (F0."movieid" < 68067)) THEN '0000000000000000000000000000000100000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 68067) AND (F0."movieid" < 70597)) THEN '0000000000000000000000000000000010000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 70597) AND (F0."movieid" < 72593)) THEN '0000000000000000000000000000000001000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 72593) AND (F0."movieid" < 74685)) THEN '0000000000000000000000000000000000100000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 74685) AND (F0."movieid" < 78211)) THEN '0000000000000000000000000000000000010000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 78211) AND (F0."movieid" < 80132)) THEN '0000000000000000000000000000000000001000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 80132) AND (F0."movieid" < 81853)) THEN '0000000000000000000000000000000000000100000000000000000000000000'::varbit WHEN ((F0."movieid" >= 81853) AND (F0."movieid" < 84103)) THEN '0000000000000000000000000000000000000010000000000000000000000000'::varbit WHEN ((F0."movieid" >= 84103) AND (F0."movieid" < 86372)) THEN '0000000000000000000000000000000000000001000000000000000000000000'::varbit WHEN ((F0."movieid" >= 86372) AND (F0."movieid" < 88049)) THEN '0000000000000000000000000000000000000000100000000000000000000000'::varbit WHEN ((F0."movieid" >= 88049) AND (F0."movieid" < 89850)) THEN '0000000000000000000000000000000000000000010000000000000000000000'::varbit WHEN ((F0."movieid" >= 89850) AND (F0."movieid" < 91566)) THEN '0000000000000000000000000000000000000000001000000000000000000000'::varbit WHEN ((F0."movieid" >= 91566) AND (F0."movieid" < 93391)) THEN '0000000000000000000000000000000000000000000100000000000000000000'::varbit WHEN ((F0."movieid" >= 93391) AND (F0."movieid" < 95352)) THEN '0000000000000000000000000000000000000000000010000000000000000000'::varbit WHEN ((F0."movieid" >= 95352) AND (F0."movieid" < 97031)) THEN '0000000000000000000000000000000000000000000001000000000000000000'::varbit WHEN ((F0."movieid" >= 97031) AND (F0."movieid" < 98751)) THEN '0000000000000000000000000000000000000000000000100000000000000000'::varbit WHEN ((F0."movieid" >= 98751) AND (F0."movieid" < 100291)) THEN '0000000000000000000000000000000000000000000000010000000000000000'::varbit WHEN ((F0."movieid" >= 100291) AND (F0."movieid" < 102058)) THEN '0000000000000000000000000000000000000000000000001000000000000000'::varbit WHEN ((F0."movieid" >= 102058) AND (F0."movieid" < 103619)) THEN '0000000000000000000000000000000000000000000000000100000000000000'::varbit WHEN ((F0."movieid" >= 103619) AND (F0."movieid" < 105159)) THEN '0000000000000000000000000000000000000000000000000010000000000000'::varbit WHEN ((F0."movieid" >= 105159) AND (F0."movieid" < 106674)) THEN '0000000000000000000000000000000000000000000000000001000000000000'::varbit WHEN ((F0."movieid" >= 106674) AND (F0."movieid" < 108212)) THEN '0000000000000000000000000000000000000000000000000000100000000000'::varbit WHEN ((F0."movieid" >= 108212) AND (F0."movieid" < 109846)) THEN '0000000000000000000000000000000000000000000000000000010000000000'::varbit WHEN ((F0."movieid" >= 109846) AND (F0."movieid" < 111626)) THEN '0000000000000000000000000000000000000000000000000000001000000000'::varbit WHEN ((F0."movieid" >= 111626) AND (F0."movieid" < 113350)) THEN '0000000000000000000000000000000000000000000000000000000100000000'::varbit WHEN ((F0."movieid" >= 113350) AND (F0."movieid" < 115149)) THEN '0000000000000000000000000000000000000000000000000000000010000000'::varbit WHEN ((F0."movieid" >= 115149) AND (F0."movieid" < 116879)) THEN '0000000000000000000000000000000000000000000000000000000001000000'::varbit WHEN ((F0."movieid" >= 116879) AND (F0."movieid" < 118756)) THEN '0000000000000000000000000000000000000000000000000000000000100000'::varbit WHEN ((F0."movieid" >= 118756) AND (F0."movieid" < 120936)) THEN '0000000000000000000000000000000000000000000000000000000000010000'::varbit WHEN ((F0."movieid" >= 120936) AND (F0."movieid" < 124348)) THEN '0000000000000000000000000000000000000000000000000000000000001000'::varbit WHEN ((F0."movieid" >= 124348) AND (F0."movieid" < 126987)) THEN '0000000000000000000000000000000000000000000000000000000000000100'::varbit WHEN ((F0."movieid" >= 126987) AND (F0."movieid" < 128991)) THEN '0000000000000000000000000000000000000000000000000000000000000010'::varbit WHEN ((F0."movieid" >= 128991) AND (F0."movieid" < 131263)) THEN '0000000000000000000000000000000000000000000000000000000000000001'::varbit END) AS "PROV_movies1"
FROM "movies" AS F0) F0 CROSS JOIN (
SELECT F0."userid" AS "userid", F0."movieid" AS "movieid", F0."rating" AS "rating", F0."timestamp" AS "timestamp", F0."rdate" AS "rdate", F0."ryear" AS "ryear", F0."rmonth" AS "rmonth", F0."rday" AS "rday", (CASE  WHEN ((F0."movieid" >= 1) AND (F0."movieid" < 25)) THEN '1000000000000000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 25) AND (F0."movieid" < 94)) THEN '0100000000000000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 94) AND (F0."movieid" < 163)) THEN '0010000000000000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 163) AND (F0."movieid" < 223)) THEN '0001000000000000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 223) AND (F0."movieid" < 288)) THEN '0000100000000000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 288) AND (F0."movieid" < 339)) THEN '0000010000000000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 339) AND (F0."movieid" < 410)) THEN '0000001000000000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 410) AND (F0."movieid" < 471)) THEN '0000000100000000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 471) AND (F0."movieid" < 537)) THEN '0000000010000000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 537) AND (F0."movieid" < 631)) THEN '0000000001000000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 631) AND (F0."movieid" < 779)) THEN '0000000000100000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 779) AND (F0."movieid" < 902)) THEN '0000000000010000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 902) AND (F0."movieid" < 945)) THEN '0000000000001000000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 945) AND (F0."movieid" < 1047)) THEN '0000000000000100000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 1047) AND (F0."movieid" < 1101)) THEN '0000000000000010000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 1101) AND (F0."movieid" < 1206)) THEN '0000000000000001000000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 1206) AND (F0."movieid" < 1228)) THEN '0000000000000000100000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 1228) AND (F0."movieid" < 1261)) THEN '0000000000000000010000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 1261) AND (F0."movieid" < 1301)) THEN '0000000000000000001000000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 1301) AND (F0."movieid" < 1373)) THEN '0000000000000000000100000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 1373) AND (F0."movieid" < 1438)) THEN '0000000000000000000010000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 1438) AND (F0."movieid" < 1573)) THEN '0000000000000000000001000000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 1573) AND (F0."movieid" < 1646)) THEN '0000000000000000000000100000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 1646) AND (F0."movieid" < 1744)) THEN '0000000000000000000000010000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 1744) AND (F0."movieid" < 1917)) THEN '0000000000000000000000001000000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 1917) AND (F0."movieid" < 1976)) THEN '0000000000000000000000000100000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 1976) AND (F0."movieid" < 2054)) THEN '0000000000000000000000000010000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 2054) AND (F0."movieid" < 2131)) THEN '0000000000000000000000000001000000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 2131) AND (F0."movieid" < 2268)) THEN '0000000000000000000000000000100000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 2268) AND (F0."movieid" < 2353)) THEN '0000000000000000000000000000010000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 2353) AND (F0."movieid" < 2421)) THEN '0000000000000000000000000000001000000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 2421) AND (F0."movieid" < 2541)) THEN '0000000000000000000000000000000100000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 2541) AND (F0."movieid" < 2664)) THEN '0000000000000000000000000000000010000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 2664) AND (F0."movieid" < 2719)) THEN '0000000000000000000000000000000001000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 2719) AND (F0."movieid" < 2859)) THEN '0000000000000000000000000000000000100000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 2859) AND (F0."movieid" < 2985)) THEN '0000000000000000000000000000000000010000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 2985) AND (F0."movieid" < 3087)) THEN '0000000000000000000000000000000000001000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 3087) AND (F0."movieid" < 3201)) THEN '0000000000000000000000000000000000000100000000000000000000000000'::varbit WHEN ((F0."movieid" >= 3201) AND (F0."movieid" < 3363)) THEN '0000000000000000000000000000000000000010000000000000000000000000'::varbit WHEN ((F0."movieid" >= 3363) AND (F0."movieid" < 3524)) THEN '0000000000000000000000000000000000000001000000000000000000000000'::varbit WHEN ((F0."movieid" >= 3524) AND (F0."movieid" < 3703)) THEN '0000000000000000000000000000000000000000100000000000000000000000'::varbit WHEN ((F0."movieid" >= 3703) AND (F0."movieid" < 3868)) THEN '0000000000000000000000000000000000000000010000000000000000000000'::varbit WHEN ((F0."movieid" >= 3868) AND (F0."movieid" < 4007)) THEN '0000000000000000000000000000000000000000001000000000000000000000'::varbit WHEN ((F0."movieid" >= 4007) AND (F0."movieid" < 4210)) THEN '0000000000000000000000000000000000000000000100000000000000000000'::varbit WHEN ((F0."movieid" >= 4210) AND (F0."movieid" < 4448)) THEN '0000000000000000000000000000000000000000000010000000000000000000'::varbit WHEN ((F0."movieid" >= 4448) AND (F0."movieid" < 4834)) THEN '0000000000000000000000000000000000000000000001000000000000000000'::varbit WHEN ((F0."movieid" >= 4834) AND (F0."movieid" < 5010)) THEN '0000000000000000000000000000000000000000000000100000000000000000'::varbit WHEN ((F0."movieid" >= 5010) AND (F0."movieid" < 5378)) THEN '0000000000000000000000000000000000000000000000010000000000000000'::varbit WHEN ((F0."movieid" >= 5378) AND (F0."movieid" < 5669)) THEN '0000000000000000000000000000000000000000000000001000000000000000'::varbit WHEN ((F0."movieid" >= 5669) AND (F0."movieid" < 6093)) THEN '0000000000000000000000000000000000000000000000000100000000000000'::varbit WHEN ((F0."movieid" >= 6093) AND (F0."movieid" < 6537)) THEN '0000000000000000000000000000000000000000000000000010000000000000'::varbit WHEN ((F0."movieid" >= 6537) AND (F0."movieid" < 6896)) THEN '0000000000000000000000000000000000000000000000000001000000000000'::varbit WHEN ((F0."movieid" >= 6896) AND (F0."movieid" < 7319)) THEN '0000000000000000000000000000000000000000000000000000100000000000'::varbit WHEN ((F0."movieid" >= 7319) AND (F0."movieid" < 8361)) THEN '0000000000000000000000000000000000000000000000000000010000000000'::varbit WHEN ((F0."movieid" >= 8361) AND (F0."movieid" < 8957)) THEN '0000000000000000000000000000000000000000000000000000001000000000'::varbit WHEN ((F0."movieid" >= 8957) AND (F0."movieid" < 30894)) THEN '0000000000000000000000000000000000000000000000000000000100000000'::varbit WHEN ((F0."movieid" >= 30894) AND (F0."movieid" < 37382)) THEN '0000000000000000000000000000000000000000000000000000000010000000'::varbit WHEN ((F0."movieid" >= 37382) AND (F0."movieid" < 45722)) THEN '0000000000000000000000000000000000000000000000000000000001000000'::varbit WHEN ((F0."movieid" >= 45722) AND (F0."movieid" < 51834)) THEN '0000000000000000000000000000000000000000000000000000000000100000'::varbit WHEN ((F0."movieid" >= 51834) AND (F0."movieid" < 56782)) THEN '0000000000000000000000000000000000000000000000000000000000010000'::varbit WHEN ((F0."movieid" >= 56782) AND (F0."movieid" < 64839)) THEN '0000000000000000000000000000000000000000000000000000000000001000'::varbit WHEN ((F0."movieid" >= 64839) AND (F0."movieid" < 74545)) THEN '0000000000000000000000000000000000000000000000000000000000000100'::varbit WHEN ((F0."movieid" >= 74545) AND (F0."movieid" < 89804)) THEN '0000000000000000000000000000000000000000000000000000000000000010'::varbit WHEN ((F0."movieid" >= 89804) AND (F0."movieid" < 131263)) THEN '0000000000000000000000000000000000000000000000000000000000000001'::varbit END) AS "PROV_ratings1"
FROM "ratings" AS F0) F1)) F0
WHERE (F0."movieid" = F0."movieid1")
GROUP BY F0."movieid", F0."title") F0) F0 ORDER BY num_ratings DESC) F0
limit 10) F0;
