SELECT bit_or(F0."PROV_movies1"::varbit) AS "PROV_movies1", bit_or(F0."PROV_ratings1"::varbit) AS "PROV_ratings1"
FROM (
SELECT F0."title" AS "title", F0."movieid" AS "movieid", F0."num_ratings" AS "num_ratings", F0."PROV_movies1" AS "PROV_movies1", F0."PROV_ratings1" AS "PROV_ratings1"
FROM (
SELECT F0."title" AS "title", F0."movieid" AS "movieid", F0."num_ratings" AS "num_ratings", F0."PROV_movies1" AS "PROV_movies1", F0."PROV_ratings1" AS "PROV_ratings1"
FROM (
SELECT F0."GROUP_1" AS "title", F0."GROUP_0" AS "movieid", F0."AGGR_0" AS "num_ratings", F0."PROV_movies1" AS "PROV_movies1", F0."PROV_ratings1" AS "PROV_ratings1"
FROM (
SELECT count(F0."rating") AS "AGGR_0", F0."movieid" AS "GROUP_0", F0."title" AS "GROUP_1", bit_or(F0."PROV_movies1"::varbit) AS "PROV_movies1", bit_or(F0."PROV_ratings1"::varbit) AS "PROV_ratings1"
FROM (
SELECT F0."movieid" AS "movieid", F0."title" AS "title", F0."genres" AS "genres", F1."userid" AS "userid", F1."movieid" AS "movieid1", F1."rating" AS "rating", F1."timestamp" AS "timestamp", F1."rdate" AS "rdate", F1."ryear" AS "ryear", F1."rmonth" AS "rmonth", F1."rday" AS "rday", F0."PROV_movies1" AS "PROV_movies1", F1."PROV_ratings1" AS "PROV_ratings1"
FROM ((
SELECT F0."movieid" AS "movieid", F0."title" AS "title", F0."genres" AS "genres", (CASE  WHEN ((F0."movieid" >= 1) AND (F0."movieid" < 868)) THEN '10000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 868) AND (F0."movieid" < 1773)) THEN '01000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 1773) AND (F0."movieid" < 2642)) THEN '00100000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 2642) AND (F0."movieid" < 3499)) THEN '00010000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 3499) AND (F0."movieid" < 4357)) THEN '00001000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 4357) AND (F0."movieid" < 5211)) THEN '00000100000000000000000000000000'::varbit WHEN ((F0."movieid" >= 5211) AND (F0."movieid" < 6065)) THEN '00000010000000000000000000000000'::varbit WHEN ((F0."movieid" >= 6065) AND (F0."movieid" < 6931)) THEN '00000001000000000000000000000000'::varbit WHEN ((F0."movieid" >= 6931) AND (F0."movieid" < 8140)) THEN '00000000100000000000000000000000'::varbit WHEN ((F0."movieid" >= 8140) AND (F0."movieid" < 25974)) THEN '00000000010000000000000000000000'::varbit WHEN ((F0."movieid" >= 25974) AND (F0."movieid" < 27548)) THEN '00000000001000000000000000000000'::varbit WHEN ((F0."movieid" >= 27548) AND (F0."movieid" < 34065)) THEN '00000000000100000000000000000000'::varbit WHEN ((F0."movieid" >= 34065) AND (F0."movieid" < 46062)) THEN '00000000000010000000000000000000'::varbit WHEN ((F0."movieid" >= 46062) AND (F0."movieid" < 53769)) THEN '00000000000001000000000000000000'::varbit WHEN ((F0."movieid" >= 53769) AND (F0."movieid" < 60293)) THEN '00000000000000100000000000000000'::varbit WHEN ((F0."movieid" >= 60293) AND (F0."movieid" < 68067)) THEN '00000000000000010000000000000000'::varbit WHEN ((F0."movieid" >= 68067) AND (F0."movieid" < 72593)) THEN '00000000000000001000000000000000'::varbit WHEN ((F0."movieid" >= 72593) AND (F0."movieid" < 78211)) THEN '00000000000000000100000000000000'::varbit WHEN ((F0."movieid" >= 78211) AND (F0."movieid" < 81853)) THEN '00000000000000000010000000000000'::varbit WHEN ((F0."movieid" >= 81853) AND (F0."movieid" < 86372)) THEN '00000000000000000001000000000000'::varbit WHEN ((F0."movieid" >= 86372) AND (F0."movieid" < 89850)) THEN '00000000000000000000100000000000'::varbit WHEN ((F0."movieid" >= 89850) AND (F0."movieid" < 93391)) THEN '00000000000000000000010000000000'::varbit WHEN ((F0."movieid" >= 93391) AND (F0."movieid" < 97031)) THEN '00000000000000000000001000000000'::varbit WHEN ((F0."movieid" >= 97031) AND (F0."movieid" < 100291)) THEN '00000000000000000000000100000000'::varbit WHEN ((F0."movieid" >= 100291) AND (F0."movieid" < 103619)) THEN '00000000000000000000000010000000'::varbit WHEN ((F0."movieid" >= 103619) AND (F0."movieid" < 106674)) THEN '00000000000000000000000001000000'::varbit WHEN ((F0."movieid" >= 106674) AND (F0."movieid" < 109846)) THEN '00000000000000000000000000100000'::varbit WHEN ((F0."movieid" >= 109846) AND (F0."movieid" < 113350)) THEN '00000000000000000000000000010000'::varbit WHEN ((F0."movieid" >= 113350) AND (F0."movieid" < 116879)) THEN '00000000000000000000000000001000'::varbit WHEN ((F0."movieid" >= 116879) AND (F0."movieid" < 120936)) THEN '00000000000000000000000000000100'::varbit WHEN ((F0."movieid" >= 120936) AND (F0."movieid" < 126987)) THEN '00000000000000000000000000000010'::varbit WHEN ((F0."movieid" >= 126987) AND (F0."movieid" < 131263)) THEN '00000000000000000000000000000001'::varbit END) AS "PROV_movies1"
FROM "movies" AS F0) F0 CROSS JOIN (
SELECT F0."userid" AS "userid", F0."movieid" AS "movieid", F0."rating" AS "rating", F0."timestamp" AS "timestamp", F0."rdate" AS "rdate", F0."ryear" AS "ryear", F0."rmonth" AS "rmonth", F0."rday" AS "rday", (CASE  WHEN ((F0."movieid" >= 1) AND (F0."movieid" < 95)) THEN '10000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 95) AND (F0."movieid" < 218)) THEN '01000000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 218) AND (F0."movieid" < 329)) THEN '00100000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 329) AND (F0."movieid" < 435)) THEN '00010000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 435) AND (F0."movieid" < 552)) THEN '00001000000000000000000000000000'::varbit WHEN ((F0."movieid" >= 552) AND (F0."movieid" < 745)) THEN '00000100000000000000000000000000'::varbit WHEN ((F0."movieid" >= 745) AND (F0."movieid" < 925)) THEN '00000010000000000000000000000000'::varbit WHEN ((F0."movieid" >= 925) AND (F0."movieid" < 1091)) THEN '00000001000000000000000000000000'::varbit WHEN ((F0."movieid" >= 1091) AND (F0."movieid" < 1213)) THEN '00000000100000000000000000000000'::varbit WHEN ((F0."movieid" >= 1213) AND (F0."movieid" < 1269)) THEN '00000000010000000000000000000000'::varbit WHEN ((F0."movieid" >= 1269) AND (F0."movieid" < 1380)) THEN '00000000001000000000000000000000'::varbit WHEN ((F0."movieid" >= 1380) AND (F0."movieid" < 1590)) THEN '00000000000100000000000000000000'::varbit WHEN ((F0."movieid" >= 1590) AND (F0."movieid" < 1779)) THEN '00000000000010000000000000000000'::varbit WHEN ((F0."movieid" >= 1779) AND (F0."movieid" < 2003)) THEN '00000000000001000000000000000000'::varbit WHEN ((F0."movieid" >= 2003) AND (F0."movieid" < 2167)) THEN '00000000000000100000000000000000'::varbit WHEN ((F0."movieid" >= 2167) AND (F0."movieid" < 2396)) THEN '00000000000000010000000000000000'::varbit WHEN ((F0."movieid" >= 2396) AND (F0."movieid" < 2639)) THEN '00000000000000001000000000000000'::varbit WHEN ((F0."movieid" >= 2639) AND (F0."movieid" < 2826)) THEN '00000000000000000100000000000000'::varbit WHEN ((F0."movieid" >= 2826) AND (F0."movieid" < 3083)) THEN '00000000000000000010000000000000'::varbit WHEN ((F0."movieid" >= 3083) AND (F0."movieid" < 3403)) THEN '00000000000000000001000000000000'::varbit WHEN ((F0."movieid" >= 3403) AND (F0."movieid" < 3717)) THEN '00000000000000000000100000000000'::varbit WHEN ((F0."movieid" >= 3717) AND (F0."movieid" < 4019)) THEN '00000000000000000000010000000000'::varbit WHEN ((F0."movieid" >= 4019) AND (F0."movieid" < 4465)) THEN '00000000000000000000001000000000'::varbit WHEN ((F0."movieid" >= 4465) AND (F0."movieid" < 5008)) THEN '00000000000000000000000100000000'::varbit WHEN ((F0."movieid" >= 5008) AND (F0."movieid" < 5754)) THEN '00000000000000000000000010000000'::varbit WHEN ((F0."movieid" >= 5754) AND (F0."movieid" < 6564)) THEN '00000000000000000000000001000000'::varbit WHEN ((F0."movieid" >= 6564) AND (F0."movieid" < 7361)) THEN '00000000000000000000000000100000'::varbit WHEN ((F0."movieid" >= 7361) AND (F0."movieid" < 26094)) THEN '00000000000000000000000000010000'::varbit WHEN ((F0."movieid" >= 26094) AND (F0."movieid" < 43652)) THEN '00000000000000000000000000001000'::varbit WHEN ((F0."movieid" >= 43652) AND (F0."movieid" < 55290)) THEN '00000000000000000000000000000100'::varbit WHEN ((F0."movieid" >= 55290) AND (F0."movieid" < 72407)) THEN '00000000000000000000000000000010'::varbit WHEN ((F0."movieid" >= 72407) AND (F0."movieid" < 131263)) THEN '00000000000000000000000000000001'::varbit END) AS "PROV_ratings1"
FROM "ratings" AS F0) F1)) F0
WHERE (F0."movieid" = F0."movieid1")
GROUP BY F0."movieid", F0."title") F0) F0 ORDER BY num_ratings DESC) F0
limit 10) F0;
