SELECT title, m.movieid, total_cnt FROM (SELECT total_cnt, movieid from (SELECT total_cnt, movieid FROM (SELECT cnt1+cnt2 AS total_cnt, t1.movieid FROM (SELECT count(*) AS cnt1, movieid FROM ratings GROUP BY movieid) r1, (SELECT count(*) AS cnt2, movieid FROM tags GROUP BY movieid) t1 WHERE r1.movieid = t1.movieid) tc1 ORDER BY total_cnt DESC) tc2 limit 10) tc3, movies m WHERE tc3.movieid = m.movieid;
