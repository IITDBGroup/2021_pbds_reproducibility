WITH _temp_view_1 AS (
SELECT /*+ materialize */ sum((F0."l_extendedprice" * (1 - F0."l_discount"))) AS "AGGR_0", F0."c_custkey" AS "GROUP_0", F0."c_name" AS "GROUP_1", F0."c_acctbal" AS "GROUP_2", F0."c_phone" AS "GROUP_3", F0."n_name" AS "GROUP_4", F0."c_address" AS "GROUP_5", F0."c_comment" AS "GROUP_6"
FROM (
SELECT F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."l_orderkey" AS "l_orderkey", F0."l_partkey" AS "l_partkey", F0."l_suppkey" AS "l_suppkey", F0."l_linenumber" AS "l_linenumber", F0."l_quantity" AS "l_quantity", F0."l_extendedprice" AS "l_extendedprice", F0."l_discount" AS "l_discount", F0."l_tax" AS "l_tax", F0."l_returnflag" AS "l_returnflag", F0."l_linestatus" AS "l_linestatus", F0."l_shipdate" AS "l_shipdate", F0."l_commitdate" AS "l_commitdate", F0."l_receiptdate" AS "l_receiptdate", F0."l_shipinstruct" AS "l_shipinstruct", F0."l_shipmode" AS "l_shipmode", F0."l_comment" AS "l_comment", F1."n_nationkey" AS "n_nationkey", F1."n_name" AS "n_name", F1."n_regionkey" AS "n_regionkey", F1."n_comment" AS "n_comment"
FROM ((
SELECT F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F1."l_orderkey" AS "l_orderkey", F1."l_partkey" AS "l_partkey", F1."l_suppkey" AS "l_suppkey", F1."l_linenumber" AS "l_linenumber", F1."l_quantity" AS "l_quantity", F1."l_extendedprice" AS "l_extendedprice", F1."l_discount" AS "l_discount", F1."l_tax" AS "l_tax", F1."l_returnflag" AS "l_returnflag", F1."l_linestatus" AS "l_linestatus", F1."l_shipdate" AS "l_shipdate", F1."l_commitdate" AS "l_commitdate", F1."l_receiptdate" AS "l_receiptdate", F1."l_shipinstruct" AS "l_shipinstruct", F1."l_shipmode" AS "l_shipmode", F1."l_comment" AS "l_comment"
FROM ((
SELECT F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F1."o_orderkey" AS "o_orderkey", F1."o_custkey" AS "o_custkey", F1."o_orderstatus" AS "o_orderstatus", F1."o_totalprice" AS "o_totalprice", F1."o_orderdate" AS "o_orderdate", F1."o_orderpriority" AS "o_orderpriority", F1."o_clerk" AS "o_clerk", F1."o_shippriority" AS "o_shippriority", F1."o_comment" AS "o_comment"
FROM ((
SELECT F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment"
FROM "customer" AS F0
WHERE (F0."c_custkey" <@ '{17865,17880,124665,124680,203085,203100,356220,356235,372615,372630,437235,437250,452310,452325,559515,559530,767175,767190,836040,836055,917085,917100,1094235,1094250,1148490,1148505,1151775,1151790,1231035,1231050,1250085,1250100,1343610,1343625,1360260,1360275,1378455,1378470,1420080,1420095}'::int[])) F0 CROSS JOIN (
SELECT F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment"
FROM "orders" AS F0
WHERE (F0."o_orderkey" <@ '{623956,624579,2715755,2716302,2795276,2795871,3055003,3055604,3527646,3528171,6190167,6190735,6404357,6404948,6441378,6442001,7844762,7845346,8091411,8092054,8413603,8414185,8549953,8550525,9246022,9246604,10494744,10495345,10502931,10503494,10759385,10759952,11633951,11634558,12178104,12178740,12451806,12452385,13557743,13558348,15056490,15057088,15114033,15114657,17283044,17283587,17320142,17320756,17613101,17613674,17797639,17798247,18410689,18411290,18872015,18872606,19430979,19431599,20309184,20309792,20446379,20446960,21712016,21712613,22260006,22260620,22941656,22942276,23414060,23414651,23727058,23727688,25986994,25987586,26338986,26339589,26730557,26731178,27457925,27458478,28936168,28936743,28961638,28962236,29959974,29960552,30313396,30314029,32588304,32588886,33420908,33421518,33488928,33489529,33645223,33645814,34697887,34698456,34787876,34788458,35364786,35365387,36192431,36192984,37363305,37363887,37839490,37840098,38049287,38049903,38785698,38786283,39517090,39517710,39739004,39739589,43568676,43569364,44233131,44233751,45770266,45770887,46028611,46029218,46356312,46356961,47583010,47583618,49724252,49724836,50282919,50283523,50391149,50391728,50731767,50732386,50822042,50822605,51139317,51139883,51787471,51788076,52314349,52314938,53333758,53334340,53559527,53560080,54135302,54135890,54401565,54402166,54444199,54444765,55047735,55048336,55152482,55153058,55156514,55157091,55940315,55940884,56107130,56107731,56613743,56614277,56933383,56933998,58854566,58855207}'::int[])) F1)) F0 CROSS JOIN (
SELECT F0."l_orderkey" AS "l_orderkey", F0."l_partkey" AS "l_partkey", F0."l_suppkey" AS "l_suppkey", F0."l_linenumber" AS "l_linenumber", F0."l_quantity" AS "l_quantity", F0."l_extendedprice" AS "l_extendedprice", F0."l_discount" AS "l_discount", F0."l_tax" AS "l_tax", F0."l_returnflag" AS "l_returnflag", F0."l_linestatus" AS "l_linestatus", F0."l_shipdate" AS "l_shipdate", F0."l_commitdate" AS "l_commitdate", F0."l_receiptdate" AS "l_receiptdate", F0."l_shipinstruct" AS "l_shipinstruct", F0."l_shipmode" AS "l_shipmode", F0."l_comment" AS "l_comment"
FROM "lineitem" AS F0
WHERE (F0."l_orderkey" <@ '{623595,624213,2715798,2716360,2795273,2795910,3054654,3055290,3527826,3528424,6190084,6190762,6404180,6404816,6441447,6442071,7844916,7845489,8091480,8092062,8413313,8413930,8549600,8550192,9246068,9246682,10494864,10495449,10502681,10503292,10759492,10760020,11634292,11634874,12178306,12178881,12452066,12452642,13557761,13558391,15056391,15057040,15114172,15114766,17282948,17283524,17320106,17320662,17613058,17613682,17797700,17798292,18410456,18411073,18872133,18872705,19430737,19431335,20308945,20309559,20446103,20446675,21711909,21712485,22259873,22260420,22941637,22942251,23414179,23414742,23727211,23727831,25986514,25987144,26339055,26339676,26730406,26731007,27458012,27458610,28936009,28936604,28961648,28962208,29960151,29960793,30313548,30314194,32588499,32589065,33420642,33421230,33488743,33489283,33645323,33645873,34697501,34698038,34787425,34788001,35364705,35365281,36192006,36192562,37362795,37363441,37839590,37840150,38049440,38050050,38785597,38786246,39516873,39517519,39739172,39739812,43568360,43568977,44233215,44233848,45770365,45770991,46028663,46029300,46356262,46356886,47583162,47583734,49724319,49724936,50282843,50283422,50391236,50391846,50731562,50732134,50821983,50822555,51139220,51139876,51787697,51788263,52314237,52314838,53333907,53334447,53559788,53560391,54134933,54135547,54401749,54402327,54444143,54444728,55047509,55048110,55152076,55152649,55156272,55156882,55940103,55940729,56107173,56107764,56613487,56614072,56933488,56934134,58854353,58854951}'::int[])) F1)) F0 CROSS JOIN "nation" AS F1)) F0
WHERE ((((((F0."c_custkey" = F0."o_custkey") and (F0."l_orderkey" = F0."o_orderkey")) and (F0."o_orderdate" >= to_date('1994-12-01', 'YYYY-MM-DD'))) and (F0."o_orderdate" < to_date('1995-03-01', 'YYYY-MM-DD'))) and (F0."l_returnflag" = 'R')) and (F0."c_nationkey" = F0."n_nationkey"))
GROUP BY F0."c_custkey", F0."c_name", F0."c_acctbal", F0."c_phone", F0."n_name", F0."c_address", F0."c_comment"),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."GROUP_0" AS "c_custkey", F0."GROUP_1" AS "c_name", F0."AGGR_0" AS "revenue", F0."GROUP_2" AS "c_acctbal", F0."GROUP_4" AS "n_name", F0."GROUP_5" AS "c_address", F0."GROUP_3" AS "c_phone", F0."GROUP_6" AS "c_comment"
FROM (SELECT * FROM _temp_view_1) F0)
SELECT F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."revenue" AS "revenue", F0."c_acctbal" AS "c_acctbal", F0."n_name" AS "n_name", F0."c_address" AS "c_address", F0."c_phone" AS "c_phone", F0."c_comment" AS "c_comment"
FROM (
SELECT F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."revenue" AS "revenue", F0."c_acctbal" AS "c_acctbal", F0."n_name" AS "n_name", F0."c_address" AS "c_address", F0."c_phone" AS "c_phone", F0."c_comment" AS "c_comment"
FROM (SELECT * FROM _temp_view_0) F0
ORDER BY F0."revenue" DESC NULLS LAST) F0
LIMIT 20;
