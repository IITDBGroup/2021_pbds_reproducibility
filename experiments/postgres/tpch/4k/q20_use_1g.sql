WITH _temp_view_1 AS (
SELECT /*+ materialize */ sum(F0."l_quantity") AS "AGGR_0", F0."l_partkey" AS "GROUP_0", F0."l_suppkey" AS "GROUP_1"
FROM (
SELECT F0."l_orderkey" AS "l_orderkey", F0."l_partkey" AS "l_partkey", F0."l_suppkey" AS "l_suppkey", F0."l_linenumber" AS "l_linenumber", F0."l_quantity" AS "l_quantity", F0."l_extendedprice" AS "l_extendedprice", F0."l_discount" AS "l_discount", F0."l_tax" AS "l_tax", F0."l_returnflag" AS "l_returnflag", F0."l_linestatus" AS "l_linestatus", F0."l_shipdate" AS "l_shipdate", F0."l_commitdate" AS "l_commitdate", F0."l_receiptdate" AS "l_receiptdate", F0."l_shipinstruct" AS "l_shipinstruct", F0."l_shipmode" AS "l_shipmode", F0."l_comment" AS "l_comment"
FROM "lineitem" AS F0
WHERE (F0."l_orderkey" <@ '{1509,3106,10560,13600,22498,23846,49091,50533,61184,62753,70052,73063,90816,92166,118695,120290,136514,138053,153061,154629,158756,160256,161700,163169,166082,167394,178275,179748,187360,191937,193376,197764,200805,202342,205318,206883,248640,250117,272706,274208,277218,278662,299648,301217,311398,312899,316032,317764,323842,325255,350692,352196,355043,356455,362404,363841,392612,395621,410021,411430,418854,420518,421989,423493,445956,447527,467362,468870,473601,475105,500483,501988,512294,515077,566918,568449,578560,580035,601441,602948,608803,610181,628581,630183,639296,640711,660261,661728,663170,664642,675360,676899,678343,679971,721701,723077,724641,725957,738148,739651,741188,742688,763236,764739,802018,803365,812196,813666,836167,837698,845316,846594,873189,874725,877703,879200,894468,896001,903650,905060,909541,912549,943621,945123,949667,951204,955680,957316,960325,963430,967559,969057,978021,979461,982465,983940,988352,991207,1004772,1006373,1021414,1022853,1036071,1037701,1042178,1043748,1060263,1061799,1085728,1087202,1111425,1112801,1135239,1136802,1160579,1162052,1174528,1175974,1232418,1234023,1260678,1262181,1272320,1274023,1286177,1289249,1303047,1304709,1310560,1312167,1330306,1331845,1333285,1336385,1355142,1356774,1374886,1377953,1383970,1385511,1393573,1395014,1445414,1446982,1466691,1468384,1507684,1509189,1510726,1512226,1513542,1514950,1526790,1528323,1549605,1551171,1555713,1557126,1559910,1561446,1595079,1596550,1599553,1601125,1605540,1607073,1611393,1612966,1645888,1647425,1668546,1669953,1675654,1677223,1712933,1714402,1729350,1730818,1744224,1745793,1759456,1761059,1762560,1764132,1770247,1771654,1782214,1783814,1813861,1815335,1822883,1824289,1836262,1837797,1842496,1843910,1851456,1852998,1857350,1858881,1868065,1869377,1870754,1872418,1881346,1882850,1894951,1896482,1902308,1903554,1925478,1927076,1937603,1939040,1946372,1948000,1974502,1975877,1978757,1980228,2015652,2017222,2021795,2023360,2035715,2037281,2088487,2089989,2119714,2121351,2130434,2134976,2139617,2140996,2144034,2145700,2155111,2156839,2173217,2174726,2177764,2179271,2200038,2201666,2258533,2260067,2262983,2264419,2265991,2267521,2280832,2283810,2303556,2304967,2307969,2309382,2322885,2324416,2355975,2357668,2416231,2417861,2428391,2429830,2444773,2446309,2447938,2449319,2458147,2459651,2469093,2470567,2484164,2485767,2493252,2494853,2496327,2499301,2514406,2515842,2535622,2537122,2558178,2559812,2582693,2584295,2587367,2588903,2593668,2595041,2605607,2607138,2611777,2613284,2627104,2629990,2636070,2639012,2646819,2648355,2663431,2664965,2670919,2672391,2673984,2675392,2684166,2687205,2694852,2696291,2713766,2715490,2734690,2736256,2737636,2739236,2787749,2789095,2817603,2819044,2826627,2829921,2831331,2832994,2844994,2846465,2855808,2857287,2861830,2863428,2880224,2881829,2891041,2892513,2913796,2915237,2944103,2945569,2961984,2963489,2975363,2976804,2981090,2984358,2997863,2999296,3003558,3005122,3017248,3018785,3027424,3028870,3034786,3037540,3043527,3046658,3055748,3057125,3063201,3064676,3068999,3070465,3080903,3082402,3095809,3097253,3101732,3103137,3118467,3119911,3121410,3123040,3165058,3166531,3169414,3172416,3173830,3175232,3188612,3190276,3227556,3229057,3253478,3255042,3284323,3285797,3308420,3309893,3312839,3314370,3344839,3346400,3350917,3352486,3360037,3361602,3396544,3397986,3399489,3402371,3406788,3408455,3409926,3411461,3415975,3417568,3429536,3430851,3432353,3433893,3456647,3458246,3489254,3490660,3540774,3542149,3555584,3557095,3569059,3570628,3583744,3588420,3604001,3605478,3610245,3611777,3620676,3622212,3647685,3649062,3695463,3696839,3702721,3704227,3726757,3728295,3732902,3735847,3764003,3765607,3772992,3774624,3776103,3777604,3792899,3796101,3800577,3802117,3804967,3806529,3817058,3818503,3831779,3833250,3841058,3842467,3847013,3850304,3870178,3871649,3873187,3876102,3880580,3882150,3925799,3927234,3937635,3939143,3959553,3961030,3977026,3979940,3982913,3984453,3989090,3990691,4023939,4025504,4088454,4089952,4122276,4123622,4187361,4188772,4202596,4204064,4223303,4224867,4238787,4241895,4258919,4260359,4310501,4312096,4314913,4316482,4318052,4319459,4337315,4338979,4384098,4385607,4393349,4394848,4446054,4447492,4448935,4450438,4480676,4482211,4483648,4485030,4489316,4490631,4495136,4496609,4508577,4510081,4530564,4531968,4533318,4534885,4576647,4577957,4584128,4587106,4642499,4644035,4651266,4654275,4681543,4683014,4707207,4708678,4717825,4719298,4743393,4746305,4764130,4765856,4769057,4770437,4776227,4777797,4793059,4794625,4835936,4837347,4871425,4872961,4878754,4880227,4909926,4911428,4913061,4914501,4976037,4977636,4998210,4999842,5016387,5017954,5035750,5037189,5040417,5041859,5052738,5054115,5058501,5059970,5072128,5073603,5090278,5091714,5098919,5100384,5110278,5113445,5115015,5116544,5142247,5143777,5148101,5149729,5156032,5158946,5177030,5178404,5210211,5211750,5222115,5223521,5235557,5237092,5238695,5240135,5250884,5252517,5272421,5273889,5278151,5281121,5284002,5285507,5295911,5297351,5372225,5373830,5379877,5381092,5439874,5441345,5442818,5445793,5459106,5462055,5488833,5491970,5497957,5499335,5546048,5549186,5614435,5615872,5618913,5620391,5623169,5624774,5630567,5633764,5635205,5636801,5657637,5659235,5681830,5683264,5711653,5713029,5735717,5738977,5744961,5746371,5759425,5763911,5789286,5790756,5798535,5799973,5829632,5831108,5913221,5914692,5923943,5926918,5984576,5986085}'::int[])) F0
WHERE ((F0."l_shipdate" >= '1993-01-01') and (F0."l_shipdate" < '1994-01-01'))
GROUP BY F0."l_partkey", F0."l_suppkey"),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."s_name" AS "s_name", F0."s_address" AS "s_address"
FROM (
SELECT F0."s_suppkey" AS "s_suppkey", F0."s_name" AS "s_name", F0."s_address" AS "s_address", F0."s_nationkey" AS "s_nationkey", F0."s_phone" AS "s_phone", F0."s_acctbal" AS "s_acctbal", F0."s_comment" AS "s_comment", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F1."ps_suppkey" AS "ps_suppkey"
FROM ((
SELECT F0."s_suppkey" AS "s_suppkey", F0."s_name" AS "s_name", F0."s_address" AS "s_address", F0."s_nationkey" AS "s_nationkey", F0."s_phone" AS "s_phone", F0."s_acctbal" AS "s_acctbal", F0."s_comment" AS "s_comment", F1."n_nationkey" AS "n_nationkey", F1."n_name" AS "n_name", F1."n_regionkey" AS "n_regionkey", F1."n_comment" AS "n_comment"
FROM ((
SELECT F0."s_suppkey" AS "s_suppkey", F0."s_name" AS "s_name", F0."s_address" AS "s_address", F0."s_nationkey" AS "s_nationkey", F0."s_phone" AS "s_phone", F0."s_acctbal" AS "s_acctbal", F0."s_comment" AS "s_comment"
FROM "supplier" AS F0
WHERE (F0."s_suppkey" <@ '{10,13,25,28,40,43,118,120,135,138,185,188,190,193,195,198,208,210,213,215,293,295,300,303,318,320,345,348,395,398,478,480,660,665,723,725,733,735,793,795,915,918,928,930,945,948,955,958,960,963,985,988,995,998,1025,1028,1045,1048,1070,1073,1105,1108,1115,1118,1145,1148,1220,1223,1238,1240,1465,1468,1610,1613,1650,1653,1673,1675,1685,1688,1703,1705,1728,1733,1785,1788,1843,1845,1875,1878,1995,1998,2020,2023,2068,2070,2098,2100,2113,2115,2183,2185,2230,2233,2263,2265,2290,2293,2393,2395,2480,2485,2500,2503,2613,2615,2630,2633,2650,2653,2663,2665,2670,2673,2695,2698,2715,2718,2760,2763,2793,2795,2903,2905,3025,3028,3068,3070,3255,3258,3268,3270,3278,3280,3340,3343,3390,3393,3430,3433,3460,3463,3628,3630,3643,3645,3663,3665,3670,3673,3728,3730,3868,3870,3875,3878,3938,3940,4045,4048,4105,4108,4130,4133,4153,4155,4173,4175,4180,4183,4193,4195,4225,4228,4240,4243,4330,4333,4430,4433,4448,4450,4470,4473,4485,4488,4495,4498,4545,4548,4628,4630,4650,4653,4665,4668,4733,4735,4755,4760,4853,4855,4920,4923,4998,5000,5082,5085,5182,5185,5265,5267,5390,5392,5422,5425,5427,5430,5540,5542,5567,5570,5592,5595,5630,5632,5700,5705,5717,5720,5757,5760,5765,5767,5832,5835,5852,5855,5877,5880,5895,5897,5922,5925,5995,5997,6015,6017,6022,6025,6050,6052,6060,6062,6070,6072,6095,6097,6105,6107,6132,6135,6255,6257,6272,6275,6292,6295,6340,6342,6437,6440,6457,6460,6602,6605,6632,6635,6720,6722,6760,6762,6832,6835,6847,6850,7082,7085,7247,7250,7265,7267,7320,7322,7467,7470,7532,7535,7585,7587,7605,7607,7650,7652,7680,7682,8012,8015,8022,8025,8187,8190,8207,8210,8272,8275,8277,8280,8440,8442,8655,8657,8667,8670,8802,8805,8895,8897,8942,8945,8967,8970,9002,9005,9050,9052,9110,9112,9222,9225,9230,9232,9237,9240,9282,9285,9307,9310,9387,9390,9432,9435,9467,9470,9522,9525,9697,9700,9755,9757,9807,9810,9895,9897,9902,9905,9940,9942,9962,9965}'::int[])) F0 CROSS JOIN "nation" AS F1)) F0 CROSS JOIN (
SELECT F0."ps_suppkey" AS "ps_suppkey"
FROM (
SELECT F0."ps_partkey" AS "ps_partkey", F0."ps_suppkey" AS "ps_suppkey", F0."ps_availqty" AS "ps_availqty", F0."ps_supplycost" AS "ps_supplycost", F0."ps_comment" AS "ps_comment", F0."p_partkey" AS "p_partkey", F1."l_partkey" AS "l_partkey", F1."l_suppkey" AS "l_suppkey", F1."sum_lq" AS "sum_lq"
FROM ((
SELECT F0."ps_partkey" AS "ps_partkey", F0."ps_suppkey" AS "ps_suppkey", F0."ps_availqty" AS "ps_availqty", F0."ps_supplycost" AS "ps_supplycost", F0."ps_comment" AS "ps_comment", F1."p_partkey" AS "p_partkey"
FROM ((
SELECT F0."ps_partkey" AS "ps_partkey", F0."ps_suppkey" AS "ps_suppkey", F0."ps_availqty" AS "ps_availqty", F0."ps_supplycost" AS "ps_supplycost", F0."ps_comment" AS "ps_comment"
FROM "partsupp" AS F0
WHERE (F0."ps_partkey" <@ '{1,4049,4147,4196,5715,5764,6009,6058,7626,7675,8116,8165,8361,8459,9096,9145,9929,9978,10027,10076,11889,11938,13163,13212,13702,13751,15466,15515,16054,16103,18210,18259,19288,19337,19582,19631,19729,19778,20170,20219,20366,20415,21640,21689,21983,22032,22228,22277,22473,22522,22620,22669,22767,22816,24335,24384,25168,25217,26050,26148,26932,27030,27961,28010,28696,28745,28941,28990,30068,30117,32665,32714,36732,36781,38055,38104,38251,38349,39231,39280,39378,39427,40113,40162,40456,40554,40750,40799,41681,41730,42122,42171,42416,42465,45062,45111,45748,45797,46091,46140,46679,46728,47218,47267,47463,47512,48296,48345,48590,48639,49717,49766,50452,50501,51530,51579,52167,52216,52755,52804,52902,52951,53049,53098,53539,53588,55695,55793,58390,58439,58831,58880,59664,59713,61232,61281,62261,62310,63878,63976,64417,64466,65936,65985,66132,66181,66573,66622,66671,66720,70885,70934,72257,72306,75246,75295,76765,76814,77647,77696,77794,77843,78823,78872,79215,79264,80489,80587,81077,81126,81714,81763,83429,83478,83723,83772,84066,84115,84213,84262,84556,84605,85095,85144,86075,86124,86859,86908,87349,87398,90093,90142,90975,91024,92102,92151,92200,92249,93082,93131,93376,93425,96659,96708,96855,96904,97198,97247,97737,97786,98472,98521,99109,99158,99697,99746,99942,99991,100089,100138,101265,101314,101657,101706,102049,102098,102343,102392,104107,104156,104842,104891,104989,105038,105283,105332,105626,105675,105871,105920,108664,108713,109056,109105,111653,111702,111800,111849,112045,112094,113221,113270,114740,114789,115916,115965,117141,117190,119248,119297,119689,119738,119983,120032,120277,120326,120816,120865,121061,121110,121649,121698,121943,121992,122629,122678,123511,123560,123952,124001,127578,127627,127774,127823,128117,128166,129636,129685,130028,130077,131596,131645,132429,132478,133654,133703,134438,134487,136447,136496,137623,137672,138554,138603,138897,138946,139877,139926,140024,140073,141494,141543,142474,142523,142572,142621,143454,143503,143601,143699,144091,144140,144875,144924,148501,148550,150314,150363,150853,150902,151784,151833,152274,152323,153009,153058,153352,153401,154136,154185,158203,158252,158546,158644,158889,158938,158987,159036,159281,159330,159820,159869,160114,160163,160751,160800,160947,160996,161731,161780,162613,162711,162760,162809,163348,163446,163544,163593,164230,164279,165651,165700,168444,168493,169032,169081,169179,169228,169865,169914,171776,171825,171972,172021,172168,172217,172609,172658,174667,174716,176676,176725,179077,179175,181037,181086,185153,185202,185692,185741,186819,186868,187064,187113,187652,187701,188436,188485,189416,189514,189612,189661,190347,190396,190690,190739,190837,190886,191033,191131,192454,192503,193875,193924,194512,194561,195051,195100,195198,195247,195345,195443,196815,196864,197256,197305,197844,197893,198187,198236,198628,198677}'::int[])) F0 CROSS JOIN (
SELECT F0."p_partkey" AS "p_partkey"
FROM (
SELECT F0."p_partkey" AS "p_partkey", F0."p_name" AS "p_name", F0."p_mfgr" AS "p_mfgr", F0."p_brand" AS "p_brand", F0."p_type" AS "p_type", F0."p_size" AS "p_size", F0."p_container" AS "p_container", F0."p_retailprice" AS "p_retailprice", F0."p_comment" AS "p_comment"
FROM "part" AS F0
WHERE (F0."p_partkey" <@ '{1650,1700,2600,2650,3350,3400,3800,3850,4150,4200,5700,5750,6000,6050,7650,7700,8150,8200,8350,8450,9100,9150,9950,10050,11900,11950,13200,13250,13700,13750,15500,15550,16050,16100,18200,18250,19300,19350,19600,19650,19700,19750,20150,20200,20350,20400,21650,21700,21950,22000,22250,22300,22450,22500,22650,22700,22750,22800,24350,24400,25200,25250,26050,26150,26950,27050,27950,28000,28700,28750,28950,29000,30050,30100,32650,32700,36750,36800,38050,38100,38250,38350,39200,39250,39350,39400,40100,40150,40450,40550,40750,40800,41700,41750,42150,42200,42400,42450,45050,45100,45750,45800,46100,46150,46650,46750,47200,47250,47450,47500,48300,48350,48600,48650,49700,49750,50450,50500,51500,51550,52150,52200,52800,52850,52900,52950,53050,53100,53550,53600,55700,55800,58400,58450,58850,58900,59650,59700,61250,61300,62250,62300,63850,63950,64400,64450,65900,65950,66100,66150,66600,66650,66700,66750,70900,70950,72300,72350,75250,75300,76750,76800,77650,77700,77800,77850,78850,78900,79200,79250,80500,80600,81100,81150,81700,81750,83400,83450,83700,83750,84050,84100,84200,84250,84550,84600,85100,85150,86100,86150,86850,86900,87350,87400,90100,90150,90950,91000,92100,92150,92200,92250,93100,93150,93400,93450,96650,96700,96900,96950,97200,97250,97700,97750,98450,98500,99150,99200,99650,99700,99950,100000,100100,100150,101250,101300,101650,101700,102050,102100,102350,102400,104100,104150,104850,104900,104950,105000,105300,105350,105600,105650,105850,105900,108650,108700,109050,109100,111650,111700,111800,111850,112050,112100,113200,113250,114750,114800,115900,115950,117150,117200,119250,119300,119700,119750,119950,120000,120250,120300,120800,120850,121050,121100,121650,121700,121950,122000,122650,122700,123500,123550,123950,124000,127600,127650,127750,127800,128150,128200,129600,129650,130000,130050,131600,131650,132400,132450,133650,133700,134400,134450,136450,136500,137650,137700,138600,138650,138900,138950,139900,139950,140000,140050,141500,141550,142450,142500,142550,142600,143450,143500,143600,143700,144100,144150,144900,144950,148500,148550,150350,150400,150850,150900,151800,151850,152250,152300,153000,153050,153350,153400,154150,154200,158200,158250,158550,158650,158900,158950,159000,159050,159300,159350,159800,159850,160150,160200,160750,160800,160950,161000,161700,161750,162600,162700,162750,162800,163350,163450,163550,163600,164200,164250,165650,165700,168400,168450,169050,169100,169200,169250,169850,169900,171800,171850,171950,172000,172200,172250,172650,172700,174700,174750,176700,176750,179100,179200,181000,181050,185150,185200,185700,185750,186800,186850,187050,187100,187650,187700,188450,188500,189450,189550,189600,189650,190350,190400,190700,190750,190800,190900,191050,191100,192450,192500,193900,193950,194500,194550,195050,195100,195200,195250,195300,195350,195400,195450,196800,196850,197250,197300,197850,197900,198200,198250,198600,198650}'::int[])) F0
WHERE (F0."p_name" like 'green%')) F1)) F0 CROSS JOIN (
SELECT F0."GROUP_0" AS "l_partkey", F0."GROUP_1" AS "l_suppkey", (0.500000 * F0."AGGR_0") AS "sum_lq"
FROM (SELECT * FROM _temp_view_1) F0) F1)) F0
WHERE ((((F0."l_partkey" = F0."ps_partkey") and (F0."l_suppkey" = F0."ps_suppkey")) and (F0."ps_availqty" > F0."sum_lq")) and (F0."ps_partkey" = F0."p_partkey"))) F1)) F0
WHERE (((F0."s_suppkey" = F0."ps_suppkey") and (F0."s_nationkey" = F0."n_nationkey")) and (F0."n_name" = 'CHINA')))
SELECT distinct F0."s_name" AS "s_name", F0."s_address" AS "s_address"
FROM (SELECT * FROM _temp_view_0) F0
ORDER BY F0."s_name" ASC NULLS LAST;
