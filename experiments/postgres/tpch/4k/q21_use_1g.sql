select
	s_name,
	count(*) as numwait
from
	(select * from supplier where s_suppkey <@
'{10,13,213,215,385,388,583,585,660,665,723,725,793,795,915,918,955,958,1025,1028,1045,1048,1105,1108,1168,1170,1220,1223,1378,1380,1485,1488,1505,1508,1585,1588,1685,1688,1703,1705,1728,1730,1783,1785,1875,1878,1928,1930,2068,2070,2098,2100,2195,2198,2230,2233,2263,2265,2290,2293,2375,2378,2480,2485,2590,2593,2613,2615,2665,2668,2680,2683,2715,2718,2735,2738,2903,2905,3390,3393,3563,3565,3643,3645,3763,3765,3875,3880,4040,4043,4045,4048,4180,4183,4448,4450,4470,4473,4485,4488,4525,4528,4645,4648,4665,4668,4723,4725,5217,5220,5540,5542,5592,5595,5757,5760,5772,5775,5780,5782,5812,5815,5827,5830,5832,5835,5852,5855,5895,5897,6022,6025,6060,6062,6105,6107,6307,6310,6357,6360,6427,6430,6537,6540,6792,6795,6847,6850,6912,6915,6965,6967,6972,6975,6992,6995,7302,7305,7355,7357,7400,7402,7410,7412,7467,7470,7532,7535,7537,7540,7585,7587,7750,7752,8562,8565,8742,8745,8762,8765,9045,9050,9237,9240,9432,9435,9522,9525,9657,9660,9937,9940}'::int[]) s,
	(select * from lineitem where l_orderkey <@
'{1,1473,2950,4453,5859,7392,10465,13315,16454,17889,19300,22246,25157,32608,34119,35778,44519,46081,55047,59462,67168,68672,70277,71808,80928,82532,83909,87014,89987,91427,101953,103526,109601,111012,126149,129094,130631,132032,136352,137893,147201,151717,162085,163458,164992,167878,170884,173891,202599,204003,205602,207365,209028,212007,214757,216192,219236,220677,226567,228164,235431,238433,241447,243079,249280,250848,253957,256897,260034,263014,266147,269413,279940,281539,289089,290466,312806,314305,318886,323360,329028,330405,333286,334853,349537,351171,360001,361504,374883,376359,382466,385383,386823,388327,391297,392803,397349,398881,400421,403558,406437,412452,419809,421188,425701,428803,437538,440545,442052,444996,446534,448033,461318,462787,471748,474657,484930,494115,500324,501857,504771,506338,507744,509218,524192,525633,531684,533312,534883,537764,539207,540609,547905,549414,559623,561184,562688,567010,569987,571367,578848,581988,586311,587875,589414,592352,593859,596775,599813,604196,605701,608614,614695,617862,619396,620902,622278,623974,627236,628578,633056,634530,637542,639043,643618,645251,646629,649607,654054,655522,656871,658563,670274,671936,673444,676579,678081,679552,680903,682372,683910,688517,694470,696103,703908,705505,718946,720422,723335,726277,727782,729223,733765,735424,736900,738401,739840,741281,742855,744550,746052,747523,748966,750438,754726,757601,759168,763424,771045,774083,782113,783494,799844,801248,807430,808933,813447,816352,819233,822086,825248,826688,834242,835718,843809,845348,856035,857539,869383,873890,876896,879969,882786,885728,888800,891746,898084,901057,902533,904034,908196,911136,915681,918656,924647,926052,930469,931973,938215,939813,942631,948480,954500,956004,957575,959072,963558,964998,966567,968039,969603,971270,983170,985991,996774,998438,1008582,1010147,1022241,1023716,1026818,1028230,1034272,1035780,1041824,1043296,1046246,1049312,1050727,1052358,1058183,1059745,1064354,1065893,1068832,1070341,1079559,1081122,1091654,1093216,1103809,1105250,1109859,1112931,1118663,1120228,1123267,1124675,1127621,1128996,1135141,1136834,1145858,1147525,1149056,1150468,1151937,1153478,1157794,1159303,1171523,1174754,1176229,1177665,1184929,1186371,1189474,1190820,1199783,1201315,1208931,1210407,1211904,1213313,1214820,1217795,1223938,1225253,1229633,1231111,1237248,1238818,1241856,1243302,1246114,1249287,1252290,1255237,1261090,1262629,1269856,1272772,1277126,1278596,1280193,1282982,1292002,1293379,1300768,1302400,1320262,1323174,1327714,1329284,1332484,1333956,1342788,1348672,1349990,1351527,1353120,1354660,1366592,1369573,1378627,1380068,1381670,1383301,1390979,1395394,1396963,1398375,1401441,1402786,1404259,1405925,1411751,1414819,1417607,1419109,1428449,1430017,1434753,1436420,1439458,1445377,1452673,1454209,1460321,1463267,1466244,1467808,1472451,1473955,1478977,1480449,1492800,1497472,1503872,1506949,1518658,1520071,1524678,1526151,1529218,1530663,1536806,1539877,1552423,1555494,1561575,1563008,1564578,1566117,1567745,1569347,1573634,1575107,1591842,1593377,1615588,1617252,1618694,1621600,1627494,1628839,1636164,1637638,1640452,1641830,1644899,1646432,1649415,1650912,1653925,1656865,1664576,1667717,1675233,1676737,1686757,1688291,1691200,1692772,1695748,1697344,1700128,1701541,1702914,1704290,1705825,1707335,1711940,1714852,1720807,1722532,1725415,1726820,1728354,1732802,1737604,1739014,1743750,1745378,1751522,1754273,1757382,1758977,1760513,1761987,1764804,1766241,1767750,1769314,1772228,1775362,1782978,1785956,1787460,1788807,1793248,1794753,1799073,1800677,1809792,1811271,1814369,1815906,1817120,1818469,1819873,1821347,1825731,1827303,1836229,1840609,1851206,1852740,1863621,1865287,1870983,1872675,1874150,1875520,1880039,1881413,1887398,1888902,1890339,1891815,1893442,1895011,1898084,1899619,1908899,1910375,1916320,1917863,1920965,1922499,1923877,1926944,1930082,1931552,1940449,1941991,1946341,1947751,1955171,1956645,1965703,1968608,1973121,1974688,1976033,1977601,1980615,1983718,1985158,1990048,1999077,2000741,2007811,2009415,2018433,2021285,2034082,2035556,2041570,2043013,2058886,2060450,2072486,2075429,2086112,2087524,2088867,2090272,2093189,2094593,2097700,2105124,2112485,2114145,2121890,2123265,2143139,2147809,2150816,2152353,2153792,2156996,2160162,2161825,2164960,2166469,2170944,2172485,2177028,2178530,2180004,2181442,2184418,2188999,2199588,2201057,2204132,2207107,2210021,2211426,2215904,2221984,2232167,2233889,2258306,2259969,2262754,2264258,2273092,2274657,2304263,2305761,2310147,2311555,2313024,2314502,2315872,2319012,2323301,2324800,2326279,2330853,2333796,2335333,2342721,2344192,2353251,2356192,2371329,2372897,2374401,2378912,2381890,2383365,2385121,2389607,2392643,2395650,2398695,2400258,2401889,2404800,2413509,2415041,2417927,2419521,2420806,2422465,2423910,2425282,2426816,2428289,2435750,2437122,2444613,2446019,2448998,2450497,2453473,2455044,2457989,2459494,2462432,2465607,2467174,2468864,2484228,2485760,2487173,2490243,2494663,2497505,2502085,2503463,2514180,2515745,2517318,2518949,2523365,2527811,2529415,2530849,2532294,2533797,2549701,2551173,2552837,2554464,2556034,2557571,2566368,2567813,2570947,2572389,2573922,2575495,2581793,2584967,2589510,2590881,2595749,2597125,2600001,2603268,2604871,2606340,2610531,2613539,2614977,2616482,2620901,2622439,2628229,2629760,2634085,2635524,2637123,2638723,2655207,2656737,2662691,2665858,2667491,2670305,2673286,2674658,2677604,2679239,2683527,2686565,2690981,2695591,2696962,2698499,2700065,2703045,2713024,2714627,2717632,2719140,2724705,2726118,2727523,2729156,2739299,2742050,2746529,2748006,2752356,2758502,2760130,2761538,2773285,2776289,2779494,2782499,2790115,2791713,2803490,2804931,2818247,2823972,2829764,2831362,2834276,2835617,2838469,2839841,2845828,2847521,2855041,2856738,2859815,2861317,2862816,2864416,2868866,2872098,2878150,2879621,2884197,2885760,2888870,2890400,2897861,2899392,2902368,2905351,2906947,2908359,2909859,2911232,2912707,2914117,2915585,2918566,2935076,2936486,2942566,2944066,2946980,2948486,2960262,2965089,2972454,2975396,2978213,2979781,2982626,2984134,2994883,2996354,2999334,3000837,3005188,3008166,3022945,3026145,3057637,3059044,3060613,3062113,3079684,3084193,3091874,3096192,3099268,3100705,3111394,3112931,3114560,3115940,3124965,3126534,3131332,3137671,3139297,3140614,3143488,3146438,3152677,3154178,3158593,3160037,3164357,3167396,3173600,3175077,3178116,3179648,3186816,3189604,3196931,3199842,3204294,3207491,3213477,3214947,3219329,3220775,3226565,3229764,3235847,3238981,3246247,3247872,3250881,3252326,3253888,3255207,3258304,3259810,3261222,3262882,3264327,3265793,3279205,3280871,3285475,3286976,3290016,3291525,3296069,3299171,3302181,3303685,3306625,3308133,3313799,3315298,3318436,3320068,3321447,3323009,3327489,3329025,3330529,3333476,3334944,3340742,3345125,3346626,3349796,3351331,3358468,3359875,3363078,3364487,3373413,3374947,3376480,3377797,3381088,3385575,3388678,3390084,3394566,3396131,3397606,3399202,3400864,3402240,3403747,3408224,3415813,3417351,3421764,3424736,3429252,3430661,3433537,3435140,3436676,3438054,3449059,3450561,3455267,3456800,3462692,3467138,3470019,3471584,3472999,3477508,3479138,3480675,3482084,3483590,3501635,3503233,3509152,3510563,3517729,3519333,3520739,3522340,3525348,3526689,3528068,3529543,3530917,3534055,3537158,3538724,3541506,3542977,3546048,3547558,3553443,3554882,3556357,3559552,3564225,3567143,3570117,3571553,3576135,3577536,3579008,3580422,3589699,3591143,3598912,3600480,3605057,3606503,3608039,3611044,3612609,3615429,3621508,3624353,3627335,3628837,3630336,3631910,3636486,3637926,3642272,3646500,3649476,3651008,3654082,3655651,3660196,3661670,3666117,3667683,3670661,3672198,3673602,3678177,3682336,3685251,3689666,3691143,3692710,3694308,3711268,3714370,3715938,3717539,3726757,3728256,3734342,3735843,3737380,3738886,3746562,3749696,3751236,3754372,3757542,3762082,3770051,3771557,3779233,3780774,3783810,3785219,3792769,3794273,3798596,3800068,3808966,3810405,3817958,3819463,3820934,3822471,3827206,3830119,3834691,3836356,3837760,3839334,3842433,3843845,3848550,3850055,3854435,3857282,3861954,3865029,3868069,3869604,3871201,3875714,3877092,3881568,3883105,3884644,3886240,3887655,3895238,3896645,3902661,3904231,3909925,3911462,3914310,3917153,3926085,3927621,3933703,3935331,3936741,3938274,3939715,3942881,3947680,3949091,3952160,3953664,3965511,3966946,3974560,3976195,3983461,3986660,3989703,3991201,4000071,4001731,4013824,4016737,4018336,4019779,4022818,4024230,4036322,4037923,4048420,4050083,4051586,4056260,4059010,4060547,4062247,4066881,4070053,4073027,4079043,4080547,4086661,4088230,4091201,4092676,4098752,4100228,4103139,4104643,4113568,4115110,4122370,4126759,4149600,4155398,4161283,4162823,4176260,4177764,4188706,4190343,4191846,4193475,4201217,4204099,4206976,4215648,4218656,4220259,4221760,4226215,4230944,4235621,4237154,4238530,4239907,4243047,4246181,4247714,4277728,4279361,4289792,4292864,4294467,4295971,4297504,4299076,4302082,4303586,4305121,4306627,4313793,4318144,4323943,4325478,4330023,4331556,4336005,4338917,4340352,4341958,4356870,4362854,4364163,4365633,4370115,4371523,4374372,4375815,4385253,4386855,4388419,4389828,4396000,4397476,4403489,4404868,4412673,4415431,4421095,4422563,4434596,4436038,4441824,4443268,4446177,4449249,4455109,4456736,4458240,4462597,4464257,4465763,4474918,4476391,4477798,4479267,4480802,4482243,4484966,4486530,4492544,4495460,4497059,4498528,4501479,4503234,4506275,4507716,4510721,4513825,4516706,4519685,4522758,4524293,4536135,4539527,4541026,4542496,4545633,4547109,4549988,4551526,4563426,4564966,4587107,4588643,4596320,4597728,4599398,4602338,4608483,4611427,4614850,4616320,4630948,4632418,4635335,4636775,4644354,4645794,4648867,4651937,4653414,4656420,4657798,4659232,4660743,4662309,4665158,4668226,4671205,4675840,4678689,4680133,4684582,4687521,4690534,4691906,4694785,4696289,4697764,4700772,4706913,4708358,4711397,4712870,4715872,4717442,4724640,4726147,4727649,4729029,4730529,4733506,4736677,4738117,4742336,4743843,4748164,4749570,4755555,4758305,4759713,4762753,4767462,4769187,4772324,4775558,4778661,4780165,4783239,4784807,4793636,4795107,4802726,4804194,4810118,4811524,4815813,4817476,4825122,4829731,4830982,4832514,4844515,4845959,4850400,4851878,4859396,4862465,4865414,4868160,4885633,4887110,4891716,4896193,4898976,4900515,4901990,4903488,4923300,4927748,4930789,4935233,4938279,4941446,4944515,4946019,4947655,4955172,4956741,4958343,4962981,4964353,4977731,4979076,4982018,4983396,4992006,4993473,5005730,5007271,5010272,5013575,5024001,5025415,5026945,5028320,5032742,5035655,5037123,5041728,5044769,5046246,5047716,5052388,5056610,5058050,5059553,5062278,5065413,5066976,5075936,5077443,5083524,5086817,5094145,5098785,5104775,5106308,5109383,5112419,5115493,5117090,5124579,5126084,5127559,5129031,5144289,5145798,5148898,5150336,5151778,5153316,5157795,5160647,5162085,5163456,5167876,5170915,5187111,5190022,5193249,5194852,5203939,5205412,5214310,5215751,5226182,5227718,5230721,5232257,5235206,5238212,5241191,5242721,5247494,5249092,5250918,5252519,5255520,5258691,5269506,5271079,5272646,5274119,5275653,5277315,5286178,5289127,5293442,5294948,5303847,5308357,5311331,5312772,5315619,5320130,5327777,5329346,5333824,5335428,5338434,5339943,5341509,5342983,5352069,5354880,5356256,5357761,5370055,5374338,5396419,5397922,5411522,5412932,5421829,5424803,5429188,5432164,5445601,5448676,5453315,5456034,5459079,5460580,5463616,5466790,5469825,5471397,5480352,5481990,5483557,5485152,5486565,5492866,5498785,5500295,5512774,5515811,5518784,5520163,5524901,5526469,5535142,5536581,5537986,5540931,5546786,5548259,5549797,5551203,5557126,5558530,5575140,5578211,5579841,5581316,5582946,5584387,5585959,5587367,5588870,5590406,5591872,5593476,5596580,5599618,5606951,5610182,5612998,5614501,5625126,5626439,5627813,5629447,5634144,5635554,5643364,5644997,5646535,5648098,5661856,5665059,5666535,5668066,5673987,5675456,5679843,5681312,5682787,5684102,5690051,5693095,5695750,5698627,5706374,5707809,5709472,5713764,5722853,5724352,5734854,5736326,5739332,5743877,5745219,5746598,5756483,5757925,5760869,5763873,5769573,5771365,5780097,5781636,5783174,5786113,5789159,5792038,5793669,5795168,5799751,5801381,5802886,5804546,5805989,5807492,5816672,5818023,5819462,5822467,5827078,5829894,5831429,5836067,5843621,5845123,5848199,5851138,5860226,5861606,5866181,5867654,5873504,5876641,5882435,5883872,5891109,5895584,5900132,5904839,5908004,5909445,5910854,5912417,5913987,5917028,5918497,5921575,5933767,5936583,5940993,5942465,5945443,5946983,5963908,5967015,5974630,5976194,5977478,5981824,5984614,5986209,5987651,5992293}'::int[]) l1,
	orders,
	nation
where
	s_suppkey = l1.l_suppkey
	and o_orderkey = l1.l_orderkey
	and o_orderstatus = 'F'
	and l1.l_receiptdate > l1.l_commitdate
	and exists (
		select
			*
		from
			lineitem l2
		where
			l2.l_orderkey = l1.l_orderkey
			and l2.l_suppkey <> l1.l_suppkey
	)
	and not exists (
		select
			*
		from
			lineitem l3
		where
			l3.l_orderkey = l1.l_orderkey
			and l3.l_suppkey <> l1.l_suppkey
			and l3.l_receiptdate > l3.l_commitdate
	)
	and s_nationkey = n_nationkey
	and n_name = 'CHINA'
group by
	s_name
order by
	numwait desc,
	s_name
LIMIT 100;
