select
	s_name,
	count(*) as numwait
from
	(select * from supplier
    WHERE (s_suppkey <@ '{960,970,2830,2840,2860,2870,4730,4740,5700,5710,6020,6030,6720,6730,6750,6760,7320,7330,7750,7760,9800,9810,9930,9940,11300,11310,12440,12450,13000,13010,16680,16690,16980,16990,17440,17450,17540,17550,17750,17760,19010,19020,20070,20080,20180,20190,21430,21440,22770,22780,24180,24190,26760,26770,27430,27440,28180,28190,28240,28250,29240,29250,29310,29320,29680,29690,31720,31730,31940,31950,32290,32300,32340,32350,32850,32860,33150,33160,33850,33860,34000,34010,35730,35740,36300,36310,36810,36820,39860,39870,40440,40450,40990,41000,43800,43810,44220,44230,44350,44360,47600,47610,47890,47900,48000,48010,48440,48450,48500,48510,49130,49140,49470,49480,49960,49970,53140,53150,54130,54140,55450,55460,55730,55740,55920,55930,56220,56230,56520,56530,56700,56710,57540,57550,58510,58520,58620,58630,61150,61160,63450,63460,65630,65640,65780,65790,67060,67070,67840,67850,68450,68460,69700,69710,70020,70030,71910,71920,73090,73100,77310,77320,78690,78700,78880,78890,79330,79340,79700,79710,80030,80040,80460,80470,80890,80900,81610,81620,82690,82700,82720,82730,89060,89070,90490,90500,92550,92560,94570,94580,95330,95340,95540,95550,96010,96020,96090,96100,96320,96330}'::int[])) s,
	lineitem l1,
	orders,
	nation
where
	s_suppkey = l1.l_suppkey
	and o_orderkey = l1.l_orderkey
	and o_orderstatus = 'F'
	and l1.l_receiptdate > l1.l_commitdate
	and exists (
		select
			*
		from
			lineitem l2
		where
			l2.l_orderkey = l1.l_orderkey
			and l2.l_suppkey <> l1.l_suppkey
	)
	and not exists (
		select
			*
		from
			lineitem l3
		where
			l3.l_orderkey = l1.l_orderkey
			and l3.l_suppkey <> l1.l_suppkey
			and l3.l_receiptdate > l3.l_commitdate
	)
	and s_nationkey = n_nationkey
	and n_name = 'CHINA'
group by
	s_name
order by
	numwait desc,
	s_name
LIMIT 100;
