select
	s_name,
	count(*) as numwait
from
	(select * from supplier where s_suppkey <@ 
'{11,12,213,214,385,386,584,585,662,664,724,725,793,794,915,916,956,957,1027,1028,1045,1046,1106,1107,1168,1169,1221,1222,1378,1379,1487,1488,1505,1506,1586,1587,1686,1687,1704,1705,1729,1730,1783,1784,1876,1877,1928,1929,2068,2069,2098,2099,2195,2196,2231,2232,2263,2264,2290,2291,2375,2376,2482,2483,2484,2485,2591,2592,2614,2615,2667,2668,2681,2682,2715,2716,2736,2737,2903,2904,3392,3393,3563,3564,3643,3644,3763,3764,3876,3877,3879,3880,4042,4043,4046,4047,4182,4183,4448,4449,4471,4472,4487,4488,4525,4526,4645,4646,4666,4667,4724,4725,5218,5219,5541,5542,5593,5594,5758,5759,5772,5773,5781,5782,5814,5815,5829,5830,5832,5833,5854,5855,5895,5896,6024,6025,6061,6062,6105,6106,6309,6310,6357,6358,6429,6430,6539,6540,6793,6794,6848,6849,6914,6915,6965,6966,6972,6973,6992,6993,7302,7303,7355,7356,7401,7402,7411,7412,7468,7469,7533,7534,7539,7540,7586,7587,7750,7751,8563,8564,8743,8744,8764,8765,9045,9046,9048,9049,9238,9239,9433,9434,9522,9523,9657,9658,9939,9940}'::int[]) s,
	(select * from lineitem where l_orderkey <@
'{643,1254,4192,4771,6592,7201,11426,11969,12576,13126,16161,17413,19813,20999,25763,27522,28677,29252,30500,31718,34853,35490,44934,45538,55171,55810,56965,57636,58210,58790,67970,68611,71041,71623,81252,81959,83623,84226,85383,85987,86625,87269,90949,91584,101699,102369,102978,103585,110145,110726,126272,126853,128066,128609,130947,131557,136388,136994,146663,147270,149763,151008,162886,163458,165282,165895,166500,167141,171362,172548,173158,173795,203296,203904,205668,206274,209862,211010,215137,215685,218626,219265,219845,220514,226500,227808,235809,236997,238180,238757,242501,243106,250277,250945,255042,256864,259840,260452,261729,262277,267618,268800,279748,280358,288832,289443,312897,313511,318918,319555,321346,321863,322435,323077,329508,330145,334502,335139,350311,350979,359494,360736,375175,375744,382785,383363,384608,385189,387523,388834,391808,392420,397315,397955,400997,401639,402214,402786,407489,408102,409223,410498,411046,411680,420162,420705,425699,426272,426852,428129,438182,439909,442944,443523,444132,444673,447012,447616,462208,462786,471653,472288,472865,473477,485250,485920,487172,487750,488964,490276,490982,491684,493441,494020,501031,501698,505794,506402,508772,509346,523680,524293,532128,532807,535904,537123,538884,539521,548039,548640,559395,560005,560640,561254,562471,563104,564800,565379,565986,566566,570817,571366,579077,579683,580320,580931,586306,586885,589280,589859,591584,592162,593889,594438,595648,596263,600422,601026,601570,602209,602785,603364,605731,606338,606946,607494,608161,608773,614791,615425,616005,616645,617280,617892,619682,620259,623335,624001,627046,627589,633635,634247,637735,638400,643811,644387,647395,648577,649186,649765,654598,655175,656932,658176,670151,670752,673218,674404,675043,675655,678692,679237,681089,681634,684581,685220,685792,686343,686951,687616,688260,688868,694337,694918,703974,704544,720099,720704,723649,724226,724801,725348,727715,728995,734401,734982,737408,737984,740320,740870,743301,744546,746977,747590,750020,750594,755332,755973,757158,757762,758976,759587,760835,761410,762496,763109,771972,772608,773254,773921,782243,783393,800836,801381,807589,808196,813410,814023,815266,815842,818919,820166,821255,821891,825504,826023,834564,835203,843845,845025,856069,856615,869159,869761,871556,872741,876898,877447,878625,879207,883523,884710,890080,891264,898979,899617,900162,900770,902690,903301,908545,910338,915744,916295,917541,918150,924928,925506,930819,931425,939265,939873,943335,944518,945698,946309,946947,947553,954789,955396,957831,958465,964416,964998,966755,967970,969767,970372,984295,984903,985606,986183,997281,997888,1008065,1008647,1021987,1022598,1026854,1027492,1034241,1034852,1043109,1043623,1046688,1047299,1047873,1048448,1050787,1051393,1059235,1059841,1064577,1065826,1068743,1069351,1079683,1080352,1091524,1092135,1104198,1105378,1110945,1112098,1119168,1119715,1124000,1124582,1128038,1128647,1134690,1135329,1145735,1146342,1149312,1149890,1153250,1153893,1157441,1158566,1171271,1171941,1173761,1174437,1176228,1177473,1186118,1186759,1190375,1190976,1199841,1201124,1209604,1210243,1211426,1212033,1215617,1216166,1216743,1217958,1224097,1224674,1229860,1231074,1238183,1238786,1241862,1242467,1247745,1248324,1253095,1253729,1254306,1254915,1262051,1262631,1270275,1270855,1271525,1272101,1276962,1278149,1281155,1282338,1292512,1292996,1300869,1301478,1320321,1320870,1321411,1322691,1327940,1328519,1332096,1332707,1333314,1333955,1343009,1343683,1344260,1345412,1346017,1346628,1347783,1348386,1350274,1350881,1353957,1354562,1366343,1366946,1367589,1368805,1379110,1379682,1382753,1383395,1390912,1391489,1393280,1393892,1394497,1395075,1396931,1397570,1402272,1402820,1404640,1405222,1412512,1413059,1414242,1414850,1417732,1418912,1428418,1428993,1436263,1436899,1439331,1439937,1441670,1442946,1444165,1445318,1453061,1453637,1460423,1461029,1462470,1463111,1466182,1466818,1472259,1472866,1478918,1479488,1492870,1493477,1495363,1495974,1496579,1497186,1504355,1505026,1505605,1506272,1519014,1519587,1524928,1525541,1530244,1530791,1536897,1537542,1539366,1540003,1553542,1554694,1562340,1562919,1564706,1565280,1568229,1568928,1574336,1574883,1592388,1592992,1615527,1616195,1618657,1619239,1621060,1621540,1627495,1628768,1637601,1638210,1641091,1641668,1645858,1646438,1650592,1651204,1654212,1655335,1656487,1657063,1664739,1665380,1665990,1666598,1676324,1676934,1687717,1688320,1691811,1693057,1696037,1696611,1700160,1700802,1703717,1704320,1705504,1706082,1712583,1715042,1721826,1722437,1725920,1726466,1728775,1729409,1730661,1731331,1732550,1733184,1737959,1738596,1743908,1745191,1751686,1752262,1752866,1753505,1758402,1758977,1761441,1762049,1765543,1766181,1767398,1768038,1772871,1773472,1774724,1775362,1783142,1784324,1785511,1786144,1788451,1789030,1793312,1793952,1799168,1799746,1810822,1811399,1815202,1815783,1817443,1818080,1821028,1821601,1826983,1827618,1835937,1836549,1838273,1838881,1839493,1840132,1851425,1852005,1864482,1865091,1871107,1871744,1874054,1874626,1880640,1881221,1888483,1889092,1890882,1891429,1894624,1895200,1899207,1899809,1909568,1910183,1916099,1916643,1920900,1921573,1923937,1924516,1926855,1927521,1929985,1930566,1940679,1941283,1946566,1947142,1955524,1956129,1965699,1966244,1968132,1968743,1973633,1974246,1977091,1977698,1980643,1981280,1981920,1982532,1984928,1985574,1986784,1987427,1988064,1988704,1999463,2000006,2008453,2009059,2018723,2019360,2019975,2020580,2034978,2035588,2042087,2042659,2059363,2059971,2073126,2073698,2074823,2075426,2085793,2086404,2089313,2089924,2092932,2093510,2098273,2098851,2099398,2099975,2101153,2101733,2102371,2103047,2103623,2104196,2113127,2113764,2122242,2122784,2144101,2145350,2145991,2146657,2151431,2152064,2154470,2156295,2160550,2161155,2166023,2166625,2170818,2171397,2177860,2178465,2180225,2180802,2184260,2185446,2186023,2186660,2187840,2188416,2199109,2200962,2205220,2205861,2206401,2207045,2210053,2210656,2215525,2216710,2218503,2219687,2220928,2221478,2232839,2233474,2259075,2259654,2263269,2263904,2272896,2273536,2305190,2305826,2309922,2310502,2312832,2313381,2316355,2316935,2317510,2318116,2324032,2325248,2327621,2328290,2328867,2330050,2334151,2334791,2343365,2343942,2353639,2354850,2371392,2372001,2374976,2375585,2376706,2377280,2378403,2379015,2381539,2383845,2385667,2386243,2387460,2388037,2388644,2389184,2393954,2394563,2395200,2395845,2398791,2399399,2401891,2402467,2404230,2404836,2414855,2415461,2417861,2418496,2421984,2422533,2424836,2425441,2427266,2427845,2436039,2436645,2444448,2445057,2448711,2449313,2454628,2455270,2458151,2459396,2462951,2463584,2465346,2465953,2468352,2468993,2485158,2485794,2487010,2487649,2488227,2488800,2489351,2489958,2494977,2495552,2496131,2496772,2503268,2503905,2513953,2514535,2517507,2518084,2524196,2524802,2526016,2526625,2527232,2527875,2530309,2530945,2532096,2532678,2549767,2551012,2553511,2554151,2556129,2556709,2565860,2566502,2571847,2572453,2573666,2574306,2574948,2575557,2582117,2582694,2583847,2584516,2589607,2590790,2596768,2597315,2599777,2600416,2601569,2602180,2605187,2605734,2611174,2611780,2613024,2613607,2615428,2616064,2621575,2622151,2628678,2629254,2634625,2635268,2637028,2638272,2655142,2655747,2662982,2663648,2665477,2666084,2667330,2667938,2668517,2669670,2673988,2674561,2678757,2679330,2683399,2685378,2690759,2691303,2691908,2693090,2694273,2694854,2697249,2697858,2700711,2701382,2702531,2703138,2713701,2714914,2717984,2718567,2724486,2725091,2728071,2728679,2739904,2741026,2746917,2747521,2751873,2753026,2753635,2754245,2756615,2757216,2758369,2759009,2760836,2761444,2773605,2774850,2779681,2780263,2780869,2781477,2782052,2782661,2790663,2791236,2804385,2804999,2818886,2819489,2820038,2821251,2821829,2823557,2830436,2830982,2834563,2835079,2839172,2839783,2846338,2846946,2856100,2856678,2859587,2860163,2863168,2864417,2869798,2871046,2878949,2879553,2884931,2885541,2888641,2889222,2898242,2898820,2903073,2903620,2904768,2905319,2907684,2908353,2909536,2910113,2913125,2913667,2915363,2916611,2917248,2917857,2935779,2936422,2942531,2943139,2947334,2947940,2960358,2960933,2962816,2963397,2964034,2964642,2972580,2973153,2974983,2975553,2978468,2979072,2982562,2983136,2995111,2995718,2999234,2999781,3005701,3006913,3024230,3024870,3026023,3026598,3057893,3058467,3061538,3062179,3081060,3082245,3082914,3083490,3092005,3092581,3093187,3093799,3095585,3096161,3099811,3100386,3112359,3112994,3115459,3116039,3126179,3126722,3132224,3132838,3133414,3134023,3134657,3135237,3135840,3136482,3140134,3140772,3144352,3144899,3145987,3146624,3153312,3153863,3158694,3159911,3164646,3165188,3165760,3166368,3173892,3174535,3179424,3180000,3187652,3188225,3188774,3189381,3197280,3197892,3199047,3199650,3204359,3205636,3206979,3207587,3213504,3214112,3219844,3220422,3226311,3226912,3228035,3228611,3229186,3229735,3236390,3236993,3237537,3238208,3246599,3247239,3251363,3252035,3254499,3255139,3258692,3259331,3261733,3262336,3264774,3265411,3279424,3280036,3285474,3286114,3291458,3292065,3295589,3296194,3297991,3298624,3302176,3302753,3306277,3306823,3313956,3315680,3318630,3319267,3321762,3322339,3327715,3328326,3331202,3331878,3332545,3333155,3334944,3335588,3336835,3337412,3337989,3338628,3339781,3340357,3345123,3345734,3350945,3351553,3358691,3359268,3362917,3363616,3373830,3374530,3376993,3377601,3381283,3381828,3382400,3382978,3384166,3384711,3389507,3390055,3395365,3395936,3399044,3399683,3402114,3402662,3403845,3404483,3406242,3406789,3407399,3408035,3416517,3417667,3421921,3422499,3423111,3423719,3429189,3429734,3435079,3435687,3437539,3438151,3448992,3449543,3455491,3456162,3462725,3463298,3464996,3466306,3470402,3471010,3473414,3473985,3475078,3476259,3479303,3479846,3482245,3482851,3502183,3502816,3510022,3510625,3517635,3518785,3521824,3522433,3526054,3526631,3527751,3528385,3531298,3531844,3532419,3532995,3537190,3537765,3541988,3542564,3546883,3547463,3553862,3554466,3556868,3557536,3559298,3559879,3564134,3564741,3566530,3567139,3570853,3571459,3576257,3576807,3579810,3580386,3590016,3590629,3599072,3599718,3605059,3605632,3608706,3609312,3609955,3610531,3613572,3614214,3614787,3615393,3622017,3623172,3623745,3624290,3628102,3628740,3631270,3631878,3636546,3637666,3642407,3643072,3644288,3644833,3645351,3646022,3649603,3650247,3655041,3655622,3660292,3660868,3666785,3667973,3671040,3671648,3673925,3674533,3675169,3675781,3676993,3677637,3682917,3684194,3689575,3690212,3693795,3694370,3711142,3712420,3713031,3713670,3716613,3717223,3727430,3728067,3734759,3735969,3738310,3738917,3746662,3747303,3749094,3749729,3751554,3752133,3752774,3753506,3758817,3760065,3761281,3761888,3769792,3770432,3771010,3771590,3779458,3780069,3783682,3784901,3792836,3794599,3798178,3798784,3809380,3809985,3817894,3818563,3820934,3821536,3828289,3828898,3829505,3830117,3834884,3835463,3838468,3839075,3843361,3843910,3848167,3848769,3854117,3854786,3855365,3856002,3862052,3862631,3863843,3864516,3868864,3869415,3871846,3872416,3873603,3874817,3877153,3877731,3878914,3880097,3883654,3884356,3886112,3886721,3895938,3896515,3903745,3904389,3910496,3911653,3914627,3915270,3917088,3917697,3926629,3927201,3933863,3934467,3937443,3937988,3940928,3942181,3947749,3948324,3952064,3952644,3966116,3966721,3974496,3975076,3984066,3985188,3990147,3990752,4000326,4000934,4014307,4014917,4016101,4016705,4019108,4019687,4022625,4023234,4036643,4037216,4049029,4049699,4052768,4053346,4053925,4054560,4055776,4056354,4059331,4059907,4062372,4063013,4063620,4064197,4064769,4066533,4070148,4070759,4071361,4071943,4078695,4079331,4080001,4080578,4087137,4087748,4091303,4091907,4098467,4099079,4103362,4103943,4114918,4115526,4122788,4123363,4123938,4124486,4126306,4126855,4149793,4150342,4150946,4151492,4152129,4152743,4154533,4155141,4162247,4162855,4176704,4177350,4188672,4189316,4193024,4193572,4200869,4201478,4202054,4202625,4203238,4203904,4207461,4208128,4209318,4210466,4211715,4212291,4213444,4215297,4220162,4220769,4221953,4222498,4223718,4224290,4226112,4226688,4231014,4231680,4233446,4234054,4235362,4236003,4237156,4237760,4239492,4240070,4240609,4241220,4242471,4243076,4246661,4247264,4278916,4279554,4290213,4290791,4292516,4293152,4294979,4295590,4297472,4298661,4302852,4303396,4305121,4305735,4314595,4315174,4315780,4316448,4316998,4317601,4323619,4324804,4330850,4331399,4336771,4337956,4340356,4340967,4357089,4357696,4359491,4360070,4360672,4361860,4364167,4364801,4370726,4371334,4374341,4374944,4385793,4386405,4388832,4389504,4397216,4397797,4404481,4405060,4413088,4413665,4414240,4414819,4421508,4422080,4435394,4435974,4442661,4443298,4446242,4446883,4447522,4448677,4455271,4455941,4458278,4458883,4459588,4460225,4461957,4462560,4463810,4464355,4475236,4475844,4478212,4478784,4481671,4482272,4484614,4485190,4492517,4493155,4494306,4494915,4497984,4498562,4502727,4503364,4506983,4507621,4510689,4511268,4513060,4513729,4517413,4517988,4518625,4519200,4523398,4524002,4535938,4536544,4538432,4539044,4541414,4541991,4545508,4546054,4550343,4550917,4563072,4563617,4564134,4564773,4587491,4588065,4596006,4597191,4600261,4601506,4609255,4609863,4610466,4611077,4614976,4615553,4631075,4631654,4635267,4635876,4644676,4645188,4649442,4650017,4651174,4651776,4653601,4654182,4655488,4656102,4657829,4658437,4661475,4662084,4666215,4667461,4672162,4673281,4675556,4676225,4678598,4679139,4684480,4685028,4686274,4686883,4690566,4691142,4694727,4695367,4698278,4698855,4700130,4700741,4707398,4708003,4710881,4712132,4716961,4717600,4725797,4726437,4728838,4729411,4731238,4731874,4732418,4733030,4736678,4737251,4741987,4742565,4743207,4743810,4748581,4749186,4756001,4756577,4757184,4757766,4759680,4760321,4760935,4761543,4767747,4768321,4773248,4773797,4774371,4774948,4779204,4779845,4784069,4784673,4794177,4794726,4803584,4804161,4810054,4810659,4815941,4816544,4824897,4825477,4827234,4829024,4831365,4831974,4844420,4845605,4851078,4851655,4858820,4859431,4860613,4862375,4866564,4867813,4885670,4886307,4893061,4895491,4898979,4899617,4902050,4902627,4923813,4924325,4924961,4925574,4926181,4926790,4931520,4932098,4932710,4933281,4934529,4935202,4938755,4939394,4940608,4941222,4944737,4945377,4948450,4948998,4949575,4950147,4951365,4955525,4956739,4957283,4963814,4964387,4977635,4978214,4982278,4982854,4992198,4992836,5006659,5007267,5010947,5011557,5012163,5012864,5024710,5025312,5028257,5028836,5032359,5032962,5034724,5035329,5037090,5037696,5039526,5040711,5044966,5045510,5047872,5049120,5049698,5050305,5052129,5052802,5056832,5057440,5060480,5061731,5065410,5066019,5076357,5077636,5083587,5084836,5085415,5086112,5095394,5095939,5096512,5097152,5098434,5099073,5106113,5106695,5109189,5109797,5110403,5111717,5115879,5116486,5124961,5125574,5127398,5128033,5144257,5144870,5149091,5149638,5151522,5152133,5157991,5159203,5159781,5160422,5162118,5162757,5168704,5169285,5170528,5171168,5186912,5187492,5188066,5188673,5189314,5189922,5193537,5194119,5204932,5205504,5214976,5215557,5227012,5227648,5231207,5231841,5234946,5235557,5236736,5237286,5241511,5242144,5248673,5249280,5251205,5251840,5255426,5256038,5256709,5257345,5258023,5258625,5269504,5270145,5273252,5273826,5276161,5276833,5286881,5287463,5288039,5288706,5294020,5294656,5304708,5305348,5306562,5307811,5311268,5312582,5315494,5316128,5317286,5317857,5318406,5318983,5327974,5328576,5334595,5335171,5339399,5340006,5341862,5342498,5352134,5352706,5353895,5354437,5356256,5357442,5370946,5371552,5372131,5373445,5397664,5398277,5412102,5412707,5422439,5423136,5424358,5424960,5429184,5429700,5430981,5431616,5446176,5446784,5447970,5448550,5452707,5453345,5455110,5455716,5459328,5459940,5464163,5464803,5465442,5466052,5470215,5470822,5481669,5482309,5484773,5485378,5486535,5487168,5488836,5489506,5490083,5490663,5491271,5491936,5499746,5500356,5513862,5515105,5519105,5519687,5525156,5525796,5534983,5535552,5538628,5539813,5547587,5548230,5550566,5551200,5557216,5557794,5575235,5575846,5576448,5577666,5580673,5581253,5582567,5583173,5585703,5586336,5588711,5589378,5591845,5592487,5596742,5597411,5598533,5599111,5606784,5607366,5609863,5610501,5614051,5614689,5625475,5626054,5628352,5628934,5633888,5634469,5635046,5635622,5644576,5645216,5647015,5648162,5662593,5663233,5663840,5664423,5666247,5666818,5674053,5674660,5679843,5680449,5683360,5683907,5690310,5690887,5692673,5693253,5695462,5696032,5697826,5698406,5706787,5707399,5710402,5711008,5712228,5713346,5722913,5723521,5734849,5735521,5739751,5740355,5742150,5743428,5745255,5745856,5757059,5757636,5760678,5761958,5762529,5763045,5770659,5771268,5780102,5780678,5783559,5784833,5785413,5785989,5789603,5790759,5791393,5791942,5794464,5795077,5800581,5801159,5803012,5803713,5806208,5806820,5816992,5817569,5820582,5821729,5827108,5827686,5828258,5828837,5831170,5832390,5833025,5833632,5835558,5836231,5843778,5844421,5848192,5848769,5850534,5851141,5860832,5861414,5866276,5866950,5873573,5874114,5876480,5877091,5882977,5883527,5891173,5891748,5892932,5893505,5894657,5895268,5900485,5901732,5902401,5903009,5904320,5904897,5908516,5909059,5911269,5911879,5913799,5914464,5916292,5916901,5919266,5919874,5920454,5921024,5934145,5934690,5935847,5936484,5941253,5941924,5945445,5946049,5946593,5947205,5963426,5965283,5965889,5967076,5974405,5975042,5977345,5977922,5979104,5979715,5980291,5980833,5985443,5986049,5988481,5989125,5990341,5990853}'::int[]) l1,
	orders,
	nation
where
	s_suppkey = l1.l_suppkey
	and o_orderkey = l1.l_orderkey
	and o_orderstatus = 'F'
	and l1.l_receiptdate > l1.l_commitdate
	and exists (
		select
			*
		from
			lineitem l2
		where
			l2.l_orderkey = l1.l_orderkey
			and l2.l_suppkey <> l1.l_suppkey
	)
	and not exists (
		select
			*
		from
			lineitem l3
		where
			l3.l_orderkey = l1.l_orderkey
			and l3.l_suppkey <> l1.l_suppkey
			and l3.l_receiptdate > l3.l_commitdate
	)
	and s_nationkey = n_nationkey
	and n_name = 'CHINA'
group by
	s_name
order by
	numwait desc,
	s_name
LIMIT 100;
