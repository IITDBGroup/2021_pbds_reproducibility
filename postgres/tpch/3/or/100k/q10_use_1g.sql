WITH _temp_view_1 AS (
SELECT /*+ materialize */ sum((F0."l_extendedprice" * (1 - F0."l_discount"))) AS "AGGR_0", F0."c_custkey" AS "GROUP_0", F0."c_name" AS "GROUP_1", F0."c_acctbal" AS "GROUP_2", F0."c_phone" AS "GROUP_3", F0."n_name" AS "GROUP_4", F0."c_address" AS "GROUP_5", F0."c_comment" AS "GROUP_6"
FROM (
SELECT F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."l_orderkey" AS "l_orderkey", F0."l_partkey" AS "l_partkey", F0."l_suppkey" AS "l_suppkey", F0."l_linenumber" AS "l_linenumber", F0."l_quantity" AS "l_quantity", F0."l_extendedprice" AS "l_extendedprice", F0."l_discount" AS "l_discount", F0."l_tax" AS "l_tax", F0."l_returnflag" AS "l_returnflag", F0."l_linestatus" AS "l_linestatus", F0."l_shipdate" AS "l_shipdate", F0."l_commitdate" AS "l_commitdate", F0."l_receiptdate" AS "l_receiptdate", F0."l_shipinstruct" AS "l_shipinstruct", F0."l_shipmode" AS "l_shipmode", F0."l_comment" AS "l_comment", F1."n_nationkey" AS "n_nationkey", F1."n_name" AS "n_name", F1."n_regionkey" AS "n_regionkey", F1."n_comment" AS "n_comment"
FROM ((
SELECT F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F1."l_orderkey" AS "l_orderkey", F1."l_partkey" AS "l_partkey", F1."l_suppkey" AS "l_suppkey", F1."l_linenumber" AS "l_linenumber", F1."l_quantity" AS "l_quantity", F1."l_extendedprice" AS "l_extendedprice", F1."l_discount" AS "l_discount", F1."l_tax" AS "l_tax", F1."l_returnflag" AS "l_returnflag", F1."l_linestatus" AS "l_linestatus", F1."l_shipdate" AS "l_shipdate", F1."l_commitdate" AS "l_commitdate", F1."l_receiptdate" AS "l_receiptdate", F1."l_shipinstruct" AS "l_shipinstruct", F1."l_shipmode" AS "l_shipmode", F1."l_comment" AS "l_comment"
FROM ((
SELECT F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F1."o_orderkey" AS "o_orderkey", F1."o_custkey" AS "o_custkey", F1."o_orderstatus" AS "o_orderstatus", F1."o_totalprice" AS "o_totalprice", F1."o_orderdate" AS "o_orderdate", F1."o_orderpriority" AS "o_orderpriority", F1."o_clerk" AS "o_clerk", F1."o_shippriority" AS "o_shippriority", F1."o_comment" AS "o_comment"
FROM ((
SELECT F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment"
FROM "customer" AS F0
WHERE (((((((((((((((((((((F0."c_custkey" >= 9787) AND (F0."c_custkey" < 9788)) OR ((F0."c_custkey" >= 13387) AND (F0."c_custkey" < 13388))) OR ((F0."c_custkey" >= 14900) AND (F0."c_custkey" < 14901))) OR ((F0."c_custkey" >= 16884) AND (F0."c_custkey" < 16890))) OR ((F0."c_custkey" >= 33632) AND (F0."c_custkey" < 33633))) OR ((F0."c_custkey" >= 34879) AND (F0."c_custkey" < 34880))) OR ((F0."c_custkey" >= 40912) AND (F0."c_custkey" < 40913))) OR ((F0."c_custkey" >= 43374) AND (F0."c_custkey" < 43380))) OR ((F0."c_custkey" >= 51811) AND (F0."c_custkey" < 51812))) OR ((F0."c_custkey" >= 54652) AND (F0."c_custkey" < 54653))) OR ((F0."c_custkey" >= 55892) AND (F0."c_custkey" < 55893))) OR ((F0."c_custkey" >= 66652) AND (F0."c_custkey" < 66653))) OR ((F0."c_custkey" >= 76792) AND (F0."c_custkey" < 76793))) OR ((F0."c_custkey" >= 88561) AND (F0."c_custkey" < 88562))) OR ((F0."c_custkey" >= 89857) AND (F0."c_custkey" < 89858))) OR ((F0."c_custkey" >= 105202) AND (F0."c_custkey" < 105203))) OR ((F0."c_custkey" >= 108397) AND (F0."c_custkey" < 108398))) OR ((F0."c_custkey" >= 122634) AND (F0."c_custkey" < 122640))) OR ((F0."c_custkey" >= 128754) AND (F0."c_custkey" < 128760))) OR ((F0."c_custkey" >= 141949) AND (F0."c_custkey" < 141950)))) F0 CROSS JOIN (
SELECT F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment"
FROM "orders" AS F0
WHERE ((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((F0."o_orderkey" >= 86034) AND (F0."o_orderkey" < 86094)) OR ((F0."o_orderkey" >= 102228) AND (F0."o_orderkey" < 102288))) OR ((F0."o_orderkey" >= 107634) AND (F0."o_orderkey" < 107694))) OR ((F0."o_orderkey" >= 134094) AND (F0."o_orderkey" < 134154))) OR ((F0."o_orderkey" >= 146690) AND (F0."o_orderkey" < 146748))) OR ((F0."o_orderkey" >= 259782) AND (F0."o_orderkey" < 259842))) OR ((F0."o_orderkey" >= 339648) AND (F0."o_orderkey" < 339708))) OR ((F0."o_orderkey" >= 374748) AND (F0."o_orderkey" < 374806))) OR ((F0."o_orderkey" >= 566690) AND (F0."o_orderkey" < 566748))) OR ((F0."o_orderkey" >= 595258) AND (F0."o_orderkey" < 595316))) OR ((F0."o_orderkey" >= 619258) AND (F0."o_orderkey" < 619316))) OR ((F0."o_orderkey" >= 680322) AND (F0."o_orderkey" < 680388))) OR ((F0."o_orderkey" >= 712800) AND (F0."o_orderkey" < 712858))) OR ((F0."o_orderkey" >= 819708) AND (F0."o_orderkey" < 819768))) OR ((F0."o_orderkey" >= 822048) AND (F0."o_orderkey" < 822108))) OR ((F0."o_orderkey" >= 829854) AND (F0."o_orderkey" < 829914))) OR ((F0."o_orderkey" >= 965322) AND (F0."o_orderkey" < 965382))) OR ((F0."o_orderkey" >= 989148) AND (F0."o_orderkey" < 989206))) OR ((F0."o_orderkey" >= 1031514) AND (F0."o_orderkey" < 1031574))) OR ((F0."o_orderkey" >= 1252494) AND (F0."o_orderkey" < 1252554))) OR ((F0."o_orderkey" >= 1411258) AND (F0."o_orderkey" < 1411316))) OR ((F0."o_orderkey" >= 1460928) AND (F0."o_orderkey" < 1460994))) OR ((F0."o_orderkey" >= 1497234) AND (F0."o_orderkey" < 1497294))) OR ((F0."o_orderkey" >= 1526632) AND (F0."o_orderkey" < 1526690))) OR ((F0."o_orderkey" >= 1571754) AND (F0."o_orderkey" < 1571814))) OR ((F0."o_orderkey" >= 1601322) AND (F0."o_orderkey" < 1601382))) OR ((F0."o_orderkey" >= 1662048) AND (F0."o_orderkey" < 1662108))) OR ((F0."o_orderkey" >= 2607342) AND (F0."o_orderkey" < 2607402))) OR ((F0."o_orderkey" >= 2735634) AND (F0."o_orderkey" < 2735694))) OR ((F0."o_orderkey" >= 2765622) AND (F0."o_orderkey" < 2765682))) OR ((F0."o_orderkey" >= 2781716) AND (F0."o_orderkey" < 2781774))) OR ((F0."o_orderkey" >= 2967222) AND (F0."o_orderkey" < 2967282))) OR ((F0."o_orderkey" >= 3002400) AND (F0."o_orderkey" < 3002458))) OR ((F0."o_orderkey" >= 3258774) AND (F0."o_orderkey" < 3258834))) OR ((F0."o_orderkey" >= 3279948) AND (F0."o_orderkey" < 3280008))) OR ((F0."o_orderkey" >= 3306654) AND (F0."o_orderkey" < 3306714))) OR ((F0."o_orderkey" >= 3447648) AND (F0."o_orderkey" < 3447708))) OR ((F0."o_orderkey" >= 3453774) AND (F0."o_orderkey" < 3453832))) OR ((F0."o_orderkey" >= 3637248) AND (F0."o_orderkey" < 3637308))) OR ((F0."o_orderkey" >= 3669294) AND (F0."o_orderkey" < 3669354))) OR ((F0."o_orderkey" >= 3676674) AND (F0."o_orderkey" < 3676734))) OR ((F0."o_orderkey" >= 3713502) AND (F0."o_orderkey" < 3713562))) OR ((F0."o_orderkey" >= 3721248) AND (F0."o_orderkey" < 3721308))) OR ((F0."o_orderkey" >= 3722034) AND (F0."o_orderkey" < 3722094))) OR ((F0."o_orderkey" >= 3827514) AND (F0."o_orderkey" < 3827574))) OR ((F0."o_orderkey" >= 3852522) AND (F0."o_orderkey" < 3852582))) OR ((F0."o_orderkey" >= 3892008) AND (F0."o_orderkey" < 3892068))) OR ((F0."o_orderkey" >= 3952374) AND (F0."o_orderkey" < 3952434))) OR ((F0."o_orderkey" >= 3992082) AND (F0."o_orderkey" < 3992142))) OR ((F0."o_orderkey" >= 4005114) AND (F0."o_orderkey" < 4005174))) OR ((F0."o_orderkey" >= 4131282) AND (F0."o_orderkey" < 4131342))) OR ((F0."o_orderkey" >= 4196448) AND (F0."o_orderkey" < 4196508))) OR ((F0."o_orderkey" >= 4236702) AND (F0."o_orderkey" < 4236762))) OR ((F0."o_orderkey" >= 4332882) AND (F0."o_orderkey" < 4332942))) OR ((F0."o_orderkey" >= 4334982) AND (F0."o_orderkey" < 4335042))) OR ((F0."o_orderkey" >= 4388322) AND (F0."o_orderkey" < 4388388))) OR ((F0."o_orderkey" >= 4601922) AND (F0."o_orderkey" < 4601988))) OR ((F0."o_orderkey" >= 4610400) AND (F0."o_orderkey" < 4610458))) OR ((F0."o_orderkey" >= 4665890) AND (F0."o_orderkey" < 4665948))) OR ((F0."o_orderkey" >= 4883514) AND (F0."o_orderkey" < 4883574))) OR ((F0."o_orderkey" >= 4890288) AND (F0."o_orderkey" < 4890348))) OR ((F0."o_orderkey" >= 4896822) AND (F0."o_orderkey" < 4896882))) OR ((F0."o_orderkey" >= 4969248) AND (F0."o_orderkey" < 4969308))) OR ((F0."o_orderkey" >= 5006690) AND (F0."o_orderkey" < 5006748))) OR ((F0."o_orderkey" >= 5084202) AND (F0."o_orderkey" < 5084262))) OR ((F0."o_orderkey" >= 5186334) AND (F0."o_orderkey" < 5186400))) OR ((F0."o_orderkey" >= 5569488) AND (F0."o_orderkey" < 5569548))) OR ((F0."o_orderkey" >= 5731962) AND (F0."o_orderkey" < 5732022))) OR ((F0."o_orderkey" >= 5778954) AND (F0."o_orderkey" < 5779014))) OR ((F0."o_orderkey" >= 5862894) AND (F0."o_orderkey" < 5862954))) OR ((F0."o_orderkey" >= 5916000) AND (F0."o_orderkey" < 5916058)))) F1)) F0 CROSS JOIN (
SELECT F0."l_orderkey" AS "l_orderkey", F0."l_partkey" AS "l_partkey", F0."l_suppkey" AS "l_suppkey", F0."l_linenumber" AS "l_linenumber", F0."l_quantity" AS "l_quantity", F0."l_extendedprice" AS "l_extendedprice", F0."l_discount" AS "l_discount", F0."l_tax" AS "l_tax", F0."l_returnflag" AS "l_returnflag", F0."l_linestatus" AS "l_linestatus", F0."l_shipdate" AS "l_shipdate", F0."l_commitdate" AS "l_commitdate", F0."l_receiptdate" AS "l_receiptdate", F0."l_shipinstruct" AS "l_shipinstruct", F0."l_shipmode" AS "l_shipmode", F0."l_comment" AS "l_comment"
FROM "lineitem" AS F0
WHERE ((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((F0."l_orderkey" >= 86078) AND (F0."l_orderkey" < 86135)) OR ((F0."l_orderkey" >= 102239) AND (F0."l_orderkey" < 102307))) OR ((F0."l_orderkey" >= 107618) AND (F0."l_orderkey" < 107678))) OR ((F0."l_orderkey" >= 134087) AND (F0."l_orderkey" < 134145))) OR ((F0."l_orderkey" >= 146702) AND (F0."l_orderkey" < 146759))) OR ((F0."l_orderkey" >= 259784) AND (F0."l_orderkey" < 259851))) OR ((F0."l_orderkey" >= 339677) AND (F0."l_orderkey" < 339746))) OR ((F0."l_orderkey" >= 374731) AND (F0."l_orderkey" < 374792))) OR ((F0."l_orderkey" >= 566647) AND (F0."l_orderkey" < 566707))) OR ((F0."l_orderkey" >= 595267) AND (F0."l_orderkey" < 595330))) OR ((F0."l_orderkey" >= 619233) AND (F0."l_orderkey" < 619297))) OR ((F0."l_orderkey" >= 680285) AND (F0."l_orderkey" < 680345))) OR ((F0."l_orderkey" >= 712799) AND (F0."l_orderkey" < 712857))) OR ((F0."l_orderkey" >= 819714) AND (F0."l_orderkey" < 819768))) OR ((F0."l_orderkey" >= 822022) AND (F0."l_orderkey" < 822082))) OR ((F0."l_orderkey" >= 829889) AND (F0."l_orderkey" < 829957))) OR ((F0."l_orderkey" >= 965349) AND (F0."l_orderkey" < 965403))) OR ((F0."l_orderkey" >= 989157) AND (F0."l_orderkey" < 989223))) OR ((F0."l_orderkey" >= 1031485) AND (F0."l_orderkey" < 1031546))) OR ((F0."l_orderkey" >= 1252463) AND (F0."l_orderkey" < 1252519))) OR ((F0."l_orderkey" >= 1411232) AND (F0."l_orderkey" < 1411300))) OR ((F0."l_orderkey" >= 1460881) AND (F0."l_orderkey" < 1460941))) OR ((F0."l_orderkey" >= 1497234) AND (F0."l_orderkey" < 1497291))) OR ((F0."l_orderkey" >= 1526626) AND (F0."l_orderkey" < 1526686))) OR ((F0."l_orderkey" >= 1571737) AND (F0."l_orderkey" < 1571788))) OR ((F0."l_orderkey" >= 1601380) AND (F0."l_orderkey" < 1601444))) OR ((F0."l_orderkey" >= 1662049) AND (F0."l_orderkey" < 1662106))) OR ((F0."l_orderkey" >= 2607374) AND (F0."l_orderkey" < 2607435))) OR ((F0."l_orderkey" >= 2735614) AND (F0."l_orderkey" < 2735674))) OR ((F0."l_orderkey" >= 2765626) AND (F0."l_orderkey" < 2765680))) OR ((F0."l_orderkey" >= 2781698) AND (F0."l_orderkey" < 2781766))) OR ((F0."l_orderkey" >= 2967216) AND (F0."l_orderkey" < 2967273))) OR ((F0."l_orderkey" >= 3002381) AND (F0."l_orderkey" < 3002441))) OR ((F0."l_orderkey" >= 3258730) AND (F0."l_orderkey" < 3258791))) OR ((F0."l_orderkey" >= 3280004) AND (F0."l_orderkey" < 3280067))) OR ((F0."l_orderkey" >= 3306625) AND (F0."l_orderkey" < 3306682))) OR ((F0."l_orderkey" >= 3447641) AND (F0."l_orderkey" < 3447698))) OR ((F0."l_orderkey" >= 3453811) AND (F0."l_orderkey" < 3453872))) OR ((F0."l_orderkey" >= 3637216) AND (F0."l_orderkey" < 3637273))) OR ((F0."l_orderkey" >= 3669333) AND (F0."l_orderkey" < 3669390))) OR ((F0."l_orderkey" >= 3676696) AND (F0."l_orderkey" < 3676757))) OR ((F0."l_orderkey" >= 3713497) AND (F0."l_orderkey" < 3713557))) OR ((F0."l_orderkey" >= 3721217) AND (F0."l_orderkey" < 3721278))) OR ((F0."l_orderkey" >= 3722056) AND (F0."l_orderkey" < 3722113))) OR ((F0."l_orderkey" >= 3827516) AND (F0."l_orderkey" < 3827579))) OR ((F0."l_orderkey" >= 3852530) AND (F0."l_orderkey" < 3852588))) OR ((F0."l_orderkey" >= 3891992) AND (F0."l_orderkey" < 3892046))) OR ((F0."l_orderkey" >= 3952352) AND (F0."l_orderkey" < 3952409))) OR ((F0."l_orderkey" >= 3992089) AND (F0."l_orderkey" < 3992152))) OR ((F0."l_orderkey" >= 4005122) AND (F0."l_orderkey" < 4005185))) OR ((F0."l_orderkey" >= 4131267) AND (F0."l_orderkey" < 4131315))) OR ((F0."l_orderkey" >= 4196400) AND (F0."l_orderkey" < 4196460))) OR ((F0."l_orderkey" >= 4236702) AND (F0."l_orderkey" < 4236765))) OR ((F0."l_orderkey" >= 4332925) AND (F0."l_orderkey" < 4332988))) OR ((F0."l_orderkey" >= 4335010) AND (F0."l_orderkey" < 4335071))) OR ((F0."l_orderkey" >= 4388314) AND (F0."l_orderkey" < 4388368))) OR ((F0."l_orderkey" >= 4601942) AND (F0."l_orderkey" < 4602000))) OR ((F0."l_orderkey" >= 4610423) AND (F0."l_orderkey" < 4610480))) OR ((F0."l_orderkey" >= 4665882) AND (F0."l_orderkey" < 4665939))) OR ((F0."l_orderkey" >= 4883501) AND (F0."l_orderkey" < 4883558))) OR ((F0."l_orderkey" >= 4890303) AND (F0."l_orderkey" < 4890360))) OR ((F0."l_orderkey" >= 4896775) AND (F0."l_orderkey" < 4896838))) OR ((F0."l_orderkey" >= 4969271) AND (F0."l_orderkey" < 4969332))) OR ((F0."l_orderkey" >= 5006688) AND (F0."l_orderkey" < 5006743))) OR ((F0."l_orderkey" >= 5084225) AND (F0."l_orderkey" < 5084286))) OR ((F0."l_orderkey" >= 5186339) AND (F0."l_orderkey" < 5186403))) OR ((F0."l_orderkey" >= 5569495) AND (F0."l_orderkey" < 5569555))) OR ((F0."l_orderkey" >= 5731958) AND (F0."l_orderkey" < 5732015))) OR ((F0."l_orderkey" >= 5778976) AND (F0."l_orderkey" < 5779039))) OR ((F0."l_orderkey" >= 5862887) AND (F0."l_orderkey" < 5862954))) OR ((F0."l_orderkey" >= 5915939) AND (F0."l_orderkey" < 5916006)))) F1)) F0 CROSS JOIN "nation" AS F1)) F0
WHERE ((((((F0."c_custkey" = F0."o_custkey") and (F0."l_orderkey" = F0."o_orderkey")) and (F0."o_orderdate" >= to_date('1994-12-01', 'YYYY-MM-DD'))) and (F0."o_orderdate" < to_date('1995-03-01', 'YYYY-MM-DD'))) and (F0."l_returnflag" = 'R')) and (F0."c_nationkey" = F0."n_nationkey"))
GROUP BY F0."c_custkey", F0."c_name", F0."c_acctbal", F0."c_phone", F0."n_name", F0."c_address", F0."c_comment"),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."GROUP_0" AS "c_custkey", F0."GROUP_1" AS "c_name", F0."AGGR_0" AS "revenue", F0."GROUP_2" AS "c_acctbal", F0."GROUP_4" AS "n_name", F0."GROUP_5" AS "c_address", F0."GROUP_3" AS "c_phone", F0."GROUP_6" AS "c_comment"
FROM (SELECT * FROM _temp_view_1) F0)
SELECT F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."revenue" AS "revenue", F0."c_acctbal" AS "c_acctbal", F0."n_name" AS "n_name", F0."c_address" AS "c_address", F0."c_phone" AS "c_phone", F0."c_comment" AS "c_comment"
FROM (
SELECT F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."revenue" AS "revenue", F0."c_acctbal" AS "c_acctbal", F0."n_name" AS "n_name", F0."c_address" AS "c_address", F0."c_phone" AS "c_phone", F0."c_comment" AS "c_comment"
FROM (SELECT * FROM _temp_view_0) F0
ORDER BY F0."revenue" DESC NULLS LAST) F0
LIMIT 20;
