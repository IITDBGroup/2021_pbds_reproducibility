                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=365771.78..365771.80 rows=10 width=44) (actual time=3600.198..3600.200 rows=10 loops=1)
   ->  Sort  (cost=365771.78..365774.94 rows=1264 width=44) (actual time=3600.198..3600.199 rows=10 loops=1)
         Sort Key: f0."AGGR_0" DESC
         Sort Method: top-N heapsort  Memory: 26kB
         ->  Subquery Scan on f0  (cost=365719.18..365744.46 rows=1264 width=44) (actual time=3599.833..3599.995 rows=513 loops=1)
               ->  HashAggregate  (cost=365719.18..365731.82 rows=1264 width=44) (actual time=3599.832..3599.949 rows=513 loops=1)
                     Group Key: f0_1.movieid
                     ->  Hash Join  (cost=70036.08..365020.92 rows=139652 width=44) (actual time=542.808..2709.576 rows=3160416 loops=1)
                           Hash Cond: (f0_2.movieid = f0_1.movieid)
                           ->  Bitmap Heap Scan on ratings f0_2  (cost=69680.74..351967.34 rows=3013793 width=16) (actual time=542.018..1459.450 rows=3197823 loops=1)
                                 Recheck Cond: (((movieid >= 94) AND (movieid < 163)) OR ((movieid >= 223) AND (movieid < 410)) OR ((movieid >= 471) AND (movieid < 631)) OR ((movieid >= 2541) AND (movieid < 2664)))
                                 Heap Blocks: exact=133152
                                 ->  BitmapOr  (cost=69680.74..69680.74 rows=3178920 width=0) (actual time=504.819..504.819 rows=0 loops=1)
                                       ->  Bitmap Index Scan on idx_rm  (cost=0.00..8019.42 rows=382298 width=0) (actual time=64.179..64.179 rows=403969 loops=1)
                                             Index Cond: ((movieid >= 94) AND (movieid < 163))
                                       ->  Bitmap Index Scan on idx_rm  (cost=0.00..28872.17 rows=1376773 width=0) (actual time=205.961..205.961 rows=1371854 loops=1)
                                             Index Cond: ((movieid >= 223) AND (movieid < 410))
                                       ->  Bitmap Index Scan on idx_rm  (cost=0.00..23222.77 rows=1107433 width=0) (actual time=177.253..177.253 rows=1111117 loops=1)
                                             Index Cond: ((movieid >= 471) AND (movieid < 631))
                                       ->  Bitmap Index Scan on idx_rm  (cost=0.00..6552.60 rows=312416 width=0) (actual time=57.425..57.425 rows=310883 loops=1)
                                             Index Cond: ((movieid >= 2541) AND (movieid < 2664))
                           ->  Hash  (cost=339.54..339.54 rows=1264 width=36) (actual time=0.773..0.773 rows=1278 loops=1)
                                 Buckets: 2048  Batches: 1  Memory Usage: 99kB
                                 ->  Bitmap Heap Scan on movies f0_1  (cost=33.98..339.54 rows=1264 width=36) (actual time=0.151..0.480 rows=1278 loops=1)
                                       Recheck Cond: (((movieid >= 1) AND (movieid < 868)) OR ((movieid >= 2215) AND (movieid < 2642)))
                                       Heap Blocks: exact=15
                                       ->  BitmapOr  (cost=33.98..33.98 rows=1278 width=0) (actual time=0.139..0.139 rows=0 loops=1)
                                             ->  Bitmap Index Scan on movies_pkey  (cost=0.00..20.81 rows=852 width=0) (actual time=0.084..0.084 rows=852 loops=1)
                                                   Index Cond: ((movieid >= 1) AND (movieid < 868))
                                             ->  Bitmap Index Scan on movies_pkey  (cost=0.00..12.54 rows=425 width=0) (actual time=0.055..0.055 rows=426 loops=1)
                                                   Index Cond: ((movieid >= 2215) AND (movieid < 2642))
 Planning time: 1.892 ms
 Execution time: 3601.003 ms
(33 rows)

