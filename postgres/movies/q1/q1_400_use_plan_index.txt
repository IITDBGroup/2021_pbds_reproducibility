                                                                                                                                                                                                                   QUERY PLAN                                                                                                                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=322115.27..322115.29 rows=10 width=44) (actual time=2604.333..2604.336 rows=10 loops=1)
   ->  Sort  (cost=322115.27..322116.62 rows=543 width=44) (actual time=2604.332..2604.335 rows=10 loops=1)
         Sort Key: f0."AGGR_0" DESC
         Sort Method: top-N heapsort  Memory: 26kB
         ->  Subquery Scan on f0  (cost=321859.71..322103.53 rows=543 width=44) (actual time=2031.290..2604.190 rows=181 loops=1)
               ->  GroupAggregate  (cost=321859.71..322098.10 rows=543 width=44) (actual time=2031.289..2604.146 rows=181 loops=1)
                     Group Key: f0_1.movieid
                     ->  Sort  (cost=321859.71..321937.36 rows=31062 width=44) (actual time=2028.747..2356.739 rows=1622633 loops=1)
                           Sort Key: f0_1.movieid
                           Sort Method: quicksort  Memory: 202744kB
                           ->  Hash Join  (cost=37694.77..319542.04 rows=31062 width=44) (actual time=293.047..1554.662 rows=1622633 loops=1)
                                 Hash Cond: (f0_2.movieid = f0_1.movieid)
                                 ->  Bitmap Heap Scan on ratings f0_2  (cost=37370.15..313055.24 rows=1560414 width=16) (actual time=292.641..927.004 rows=1622633 loops=1)
                                       Recheck Cond: (((movieid >= 107) AND (movieid < 126)) OR ((movieid >= 252) AND (movieid < 269)) OR ((movieid >= 277) AND (movieid < 303)) OR ((movieid >= 308) AND (movieid < 327)) OR ((movieid >= 355) AND (movieid < 371)) OR ((movieid >= 471) AND (movieid < 481)) OR ((movieid >= 516) AND (movieid < 529)) OR ((movieid >= 569) AND (movieid < 611)) OR ((movieid >= 2551) AND (movieid < 2572)))
                                       Heap Blocks: exact=128740
                                       ->  BitmapOr  (cost=37370.15..37370.15 rows=1613929 width=0) (actual time=257.652..257.652 rows=0 loops=1)
                                             ->  Bitmap Index Scan on idx_rm  (cost=0.00..2170.80 rows=103436 width=0) (actual time=21.570..21.570 rows=112662 loops=1)
                                                   Index Cond: ((movieid >= 107) AND (movieid < 126))
                                             ->  Bitmap Index Scan on idx_rm  (cost=0.00..3027.13 rows=144269 width=0) (actual time=25.204..25.204 rows=159065 loops=1)
                                                   Index Cond: ((movieid >= 252) AND (movieid < 269))
                                             ->  Bitmap Index Scan on idx_rm  (cost=0.00..4336.14 rows=206770 width=0) (actual time=31.106..31.106 rows=210264 loops=1)
                                                   Index Cond: ((movieid >= 277) AND (movieid < 303))
                                             ->  Bitmap Index Scan on idx_rm  (cost=0.00..3288.14 rows=156770 width=0) (actual time=21.984..21.984 rows=149334 loops=1)
                                                   Index Cond: ((movieid >= 308) AND (movieid < 327))
                                             ->  Bitmap Index Scan on idx_rm  (cost=0.00..4716.14 rows=224770 width=0) (actual time=34.714..34.714 rows=231997 loops=1)
                                                   Index Cond: ((movieid >= 355) AND (movieid < 371))
                                             ->  Bitmap Index Scan on idx_rm  (cost=0.00..2269.46 rows=108102 width=0) (actual time=16.684..16.684 rows=107267 loops=1)
                                                   Index Cond: ((movieid >= 471) AND (movieid < 481))
                                             ->  Bitmap Index Scan on idx_rm  (cost=0.00..1962.79 rows=93435 width=0) (actual time=14.370..14.370 rows=90628 loops=1)
                                                   Index Cond: ((movieid >= 516) AND (movieid < 529))
                                             ->  Bitmap Index Scan on idx_rm  (cost=0.00..10436.51 rows=497607 width=0) (actual time=76.291..76.291 rows=487780 loops=1)
                                                   Index Cond: ((movieid >= 569) AND (movieid < 611))
                                             ->  Bitmap Index Scan on idx_rm  (cost=0.00..1652.13 rows=78769 width=0) (actual time=15.723..15.723 rows=73636 loops=1)
                                                   Index Cond: ((movieid >= 2551) AND (movieid < 2572))
                                 ->  Hash  (cost=317.83..317.83 rows=543 width=36) (actual time=0.384..0.384 rows=546 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 44kB
                                       ->  Bitmap Heap Scan on movies f0_1  (cost=22.72..317.83 rows=543 width=36) (actual time=0.093..0.235 rows=546 loops=1)
                                             Recheck Cond: (((movieid >= 69) AND (movieid < 138)) OR ((movieid >= 206) AND (movieid < 619)) OR ((movieid >= 2539) AND (movieid < 2608)))
                                             Heap Blocks: exact=9
                                             ->  BitmapOr  (cost=22.72..22.72 rows=546 width=0) (actual time=0.084..0.084 rows=0 loops=1)
                                                   ->  Bitmap Index Scan on movies_pkey  (cost=0.00..4.97 rows=68 width=0) (actual time=0.021..0.021 rows=68 loops=1)
                                                         Index Cond: ((movieid >= 69) AND (movieid < 138))
                                                   ->  Bitmap Index Scan on movies_pkey  (cost=0.00..12.38 rows=409 width=0) (actual time=0.043..0.043 rows=409 loops=1)
                                                         Index Cond: ((movieid >= 206) AND (movieid < 619))
                                                   ->  Bitmap Index Scan on movies_pkey  (cost=0.00..4.97 rows=68 width=0) (actual time=0.020..0.020 rows=69 loops=1)
                                                         Index Cond: ((movieid >= 2539) AND (movieid < 2608))
 Planning time: 2.320 ms
 Execution time: 2614.658 ms
(48 rows)

